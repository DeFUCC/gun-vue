import * as debug from 'debug';
import fs from 'fs';
import { ViteDevServer, Plugin } from 'vite';

declare type ImportMode = 'sync' | 'async';
declare type ImportModeResolveFn = (filepath: string) => ImportMode;
declare type CustomBlock = Record<string, any>;
declare type SupportedPagesResolver = 'vue' | 'react';
interface PageOptions {
    dir: string;
    baseRoute: string;
}
/**
 * Plugin options.
 */
interface Options {
    /**
     * Paths to the directory to search for page components.
     * @default 'src/pages'
     */
    dirs: string | (string | PageOptions)[];
    /**
     * Valid file extensions for page components.
     * @default ['vue', 'js']
     */
    extensions: string[];
    /**
     * List of path globs to exclude when resolving pages.
     */
    exclude: string[];
    /**
     * Import routes directly or as async components
     * @default 'async'
     */
    importMode: ImportMode | ImportModeResolveFn;
    /**
     * Sync load top level index file
     * @default true
     */
    syncIndex: boolean;
    /**
     * Use Nuxt.js style route naming
     * @default false
     */
    nuxtStyle: boolean;
    /**
     * Set the default route block parser, or use `<route lang=xxx>` in SFC route block
     * @default 'json5'
     */
    routeBlockLang: 'json5' | 'json' | 'yaml' | 'yml';
    /**
     * Generate React Route
     * @default 'auto detect'
     */
    resolver: SupportedPagesResolver;
    /**
     * Extend route records
     */
    extendRoute?: (route: any, parent: any | undefined) => any | void;
    /**
     * Custom generated routes
     */
    onRoutesGenerated?: (routes: any[]) => any[] | void | Promise<any[] | void>;
    /**
     * Custom generated client code
     */
    onClientGenerated?: (clientCode: string) => string | void | Promise<string | void>;
}
declare type UserOptions = Partial<Options>;
interface ResolvedOptions extends Options {
    /**
     * Resolves to the `root` value from Vite config.
     * @default config.root
     */
    root: string;
    /**
     * Resolved page dirs
     */
    dirs: PageOptions[];
    /**
     * RegExp to match extensions
     */
    extensionsRE: RegExp;
}

declare type PageRoute = {
    path: string;
    route: string;
};
declare class PageContext {
    private _server;
    private _pageRouteMap;
    private _customBlockMap;
    rawOptions: UserOptions;
    root: string;
    options: ResolvedOptions;
    constructor(userOptions?: UserOptions);
    setRoot(root: string): void;
    setResolver(resolver: SupportedPagesResolver): void;
    setupViteServer(server: ViteDevServer): void;
    setupWatcher(watcher: fs.FSWatcher): void;
    addPage(path: string | string[], pageDir: PageOptions): Promise<void>;
    removePage(path: string | string[]): void;
    checkCustomBlockChange(path: string): Promise<void>;
    onUpdate(): void;
    resolveRoutes(): Promise<string | undefined>;
    searchGlob(): Promise<void>;
    get debug(): {
        hmr: debug.Debugger;
        routeBlock: debug.Debugger;
        options: debug.Debugger;
        pages: debug.Debugger;
        search: debug.Debugger;
        env: debug.Debugger;
        cache: debug.Debugger;
        resolver: debug.Debugger;
    };
    get pageRouteMap(): Map<string, PageRoute>;
    get customBlockMap(): Map<string, CustomBlock>;
}

declare function pagesPlugin(userOptions?: UserOptions): Plugin;

export { CustomBlock, ImportMode, ImportModeResolveFn, PageContext, PageOptions, ResolvedOptions, SupportedPagesResolver, UserOptions, pagesPlugin as default };
