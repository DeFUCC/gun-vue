import{m as p,n as h,I as m,at as d,au as f}from"./components.175bfd8d.js";import{f as g}from"./force-graph.79228061.js";import{d as b,h as k,ag as _,g as v,j as w,y as x,b6 as y,o as j,c as C,k as E}from"./framework.4eb5045b.js";import"../app.145f5e9a.js";import"./theme.9a7457db.js";const D=E("div",{id:"graph"},null,-1),R=[D],I=b({__name:"UserGraph",emits:["user"],setup(B,{emit:u}){const s=k(null),n=p("deep"),c=h(),a=_({});c.user(m.pub).get("space").map().once(async(e,r)=>{a[r]={pub:r,name:await c.user(r).get("profile").get("name").then(),color:n.hex(r),links:d(r)}});const i=v(()=>{let e=[];return Object.values(a).forEach(r=>{Object.entries(r.links).forEach(t=>{!a[t[0]]||!t[1].text||e.push({source:r.pub,target:t[0],emoji:t[1].emoji,back:t[1].back})})}),e}),o=g().width(600).nodeId("pub").nodeColor("color").nodeVal(e=>e.pub==f.pub?10:1).nodeRelSize(4).linkDirectionalArrowLength(4).linkDirectionalArrowRelPos(1).linkLabel("emoji").linkCurvature(.2).linkColor(e=>{var r;return n.hex(((r=e.source)==null?void 0:r.pub)||0)}).linkWidth(e=>e.back?3:1).onNodeDragEnd(e=>{e.fx=e.x,e.fy=e.y}).onNodeClick(e=>{o.centerAt(e.x,e.y,1e3),o.zoom(4,2e3)}).onNodeClick(e=>{u("user",e.pub)});return w(()=>{o(document.getElementById("graph"))}),x(()=>o.graphData({nodes:Object.values(a),links:i.value})),y(s,e=>{const r=e[0],{width:t,height:l}=r.contentRect;o.width(t),o.height(l)}),(e,r)=>(j(),C("div",{class:"bg-light-700 dark-bg-dark-500 overflow-none w-full max-w-90vw max-h-90vh h-full",ref_key:"graph",ref:s},R,512))}});export{I as default};
