import{d as E,f as h,x as F,o as l,c,E as e,t as p,e as n,a5 as L,L as y,H as C,I as _,T,G as S,F as N,U as Q,w as R}from"./framework.a3669fa7.js";import{E as V,F as D}from"./theme.57de3033.js";import{a5 as G,E as q,a6 as I,U as M,a7 as j,n as z,a as A}from"./components.fbcbebd5.js";import"../app.d133453d.js";const J={class:"flex flex-col gap-4 p-4 break-all"},K={key:0,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center"},O=e("div",{class:"font-bold"},"Share a file",-1),P=e("div",{class:"font-bold"},"Sharing a file:",-1),W={class:"text-md max-w-55ch"},X={class:"flex-1 font-mono text-xs min-w-10"},Y={class:"p-0"},Z={class:"flex flex-wrap gap-2 p-4 items-start"},ee={key:0,class:"flex flex-col gap-2"},se=e("div",{class:"text-xl"},"Sharing the torrent",-1),te={class:"font-mono text-sm"},ae=["href"],oe=e("div",{class:"i-la-link"},null,-1),le=e("div",{class:"p-0"},"Download URL",-1),ne=[oe,le],ie=e("div",{class:"i-la-copy"},null,-1),re={class:"p-0"},de=e("div",{class:"i-la-share"},null,-1),ue=e("div",{class:"p-0"}," Share",-1),ce=[de,ue],pe=e("div",{class:"i-la-qrcode"},null,-1),ve={class:"p-0"},fe=e("div",{class:"i-la-file"},null,-1),he={class:"p-0"},be=E({__name:"TorrentUpload",emits:["uploaded"],setup(_e,{emit:$}){const t=h();h();const v=h(!1),m=h(!1),g=h(!1);function H(a){var i;const{torrent:s}=j((i=a==null?void 0:a.target)==null?void 0:i.files);z();const{user:d}=A();R(s,async u=>{t.value=u,v.value=!0;const o={infoHash:u.infoHash,length:u.length,name:u.name,author:d.pub};$("uploaded",o)})}const f=F(()=>{var s,d,i;if(!((s=t.value)!=null&&s.infoHash))return"";let a=new URL((d=window==null?void 0:window.location)==null?void 0:d.href);return`${a.protocol}//${a.hostname}${a.port?`:${a.port}`:""}/#/files/${(i=t.value)==null?void 0:i.infoHash}`}),k=V({source:f}),{share:U,isSupported:B}=D();return(a,s)=>{var d,i,u;return l(),c("div",J,[t.value?(l(),c("div",{key:1,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center break-all",onClick:s[2]||(s[2]=o=>v.value=!v.value)},[P,e("div",W,p((d=t.value)==null?void 0:d.name),1),e("div",X,p((i=t.value)==null?void 0:i.infoHash),1),e("div",Y,p(n(G)((u=t.value)==null?void 0:u.length)),1),e("div",{class:"i-la-times",onClick:s[1]||(s[1]=L(o=>t.value=null,["prevent","stop"]))})])):(l(),c("label",K,[O,e("input",{class:"max-w-30",type:"file",accept:"image/*",onChange:s[0]||(s[0]=o=>H(o))},null,32)])),y(n(M),{open:v.value,onClose:s[7]||(s[7]=o=>v.value=!1)},{default:C(()=>{var o,x,b;return[e("div",Z,[t.value?(l(),c("div",ee,[se,e("div",te,p((o=t.value)==null?void 0:o.infoHash),1),e("a",{class:"gap-2 button underline font-bold break-all",href:f.value,target:"_blank"},ne,8,ae),n(k).isSupported.value?(l(),c("button",{key:0,class:"p-2 button gap-2",onClick:s[3]||(s[3]=r=>n(k).copy())},[ie,e("div",re,p((x=n(k))!=null&&x.copied.value?"Copied!":"Copy"),1)])):_("",!0),n(B)?(l(),c("button",{key:1,class:"p-2 button gap-2",onClick:s[4]||(s[4]=r=>{var w;return n(U)({title:(w=t.value)==null?void 0:w.name,url:f.value})})},ce)):_("",!0),e("button",{class:"button p-2 gap-2",onClick:s[5]||(s[5]=r=>m.value=!m.value)},[pe,e("div",ve,p(m.value?"Hide":"Show")+" QR ",1)]),e("button",{class:"button p-2 gap-2",onClick:s[6]||(s[6]=r=>g.value=!g.value)},[fe,e("div",he,p(g.value?"Hide":"Show")+" file ",1)])])):_("",!0),y(T,{name:"fade"},{default:C(()=>[f.value&&m.value?(l(),S(n(q),{key:0,data:f.value},null,8,["data"])):_("",!0)]),_:1}),g.value?(l(!0),c(N,{key:1},Q((b=t.value)==null?void 0:b.files,r=>(l(),S(n(I),{class:"flex-auto",key:r==null?void 0:r.name,file:r},null,8,["file"]))),128)):_("",!0)])]}),_:1},8,["open"])])}}});export{be as default};
