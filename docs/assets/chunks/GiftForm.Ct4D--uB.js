var X=Object.defineProperty;var Z=(e,t,i)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var N=(e,t,i)=>Z(e,typeof t!="symbol"?t+"":t,i);import{d as ee,p as D,h as $,q as Y,aQ as te,aB as _,o as f,c as b,aj as ne,ai as J,B as se,j as d,k as r,b as S,w as I,t as j,F as C,C as P,G as z,K as ie,aP as le,aC as re,a as oe,e as R,N as H}from"./framework.D0CZGv0r.js";import{a as ae,o as ue,h as pe,m as q,r as ce,P as me,ap as de}from"./components.BF3VL1wl.js";import{u as fe}from"./useGuests.DNhkCDeB.js";import{a as ve}from"./useGift.DwZ54uS8.js";import{u as ge}from"./useProject.BcxVISgX.js";import{u as he}from"./useProjects.Wv4Cr2hj.js";import"./theme.DNNfahvK.js";import{c as be}from"./currencies.G9pkebxG.js";import"./composables.Dkv7Zox7.js";/**
 * Vue Number Format 3.34.1
 * (c) 2021-2023 Dipak Sarkar <hello@dipaksarkar.in> (https://dipaksarkar.in/)
 * @license MIT
 */var U={prefix:"",suffix:"",separator:",",decimal:".",precision:2,minimumFractionDigits:null,prefill:!0,reverseFill:!1,min:null,max:null,nullValue:""};function xe(e){return t=0,i=e,a=20,Math.max(t,Math.min(i,a));var t,i,a}class A{constructor(t){N(this,"options");N(this,"input");N(this,"number");N(this,"isClean");N(this,"preSurRegExp");N(this,"numberRegExp");N(this,"cleanRegExp");N(this,"negativeRegExp");this.options=Object.assign(Q(U),t);const{prefix:i,suffix:a,decimal:p,reverseFill:n}=this.options;this.input="",this.number="",this.isClean=!n;const o=i.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),s=a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");this.preSurRegExp=new RegExp(`${o}|${s}`,"g"),this.numberRegExp=new RegExp(`[^0-9\\${p}]+`,"gi"),this.cleanRegExp=new RegExp("[^0-9]+","gi"),this.negativeRegExp=new RegExp("[^0-9\\-]+","gi")}isNull(){return!this.numberOnly(this.isClean?this.cleanRegExp:this.negativeRegExp)}clean(t=!1){return this.isClean=t,this}sign(){if(this.input===null||this.input===void 0)return"";const t=this.input.toString().indexOf("-")>=0;return this.isClean?t&&this.realNumber()>0?"-":"":t?"-":""}toFixed(){const t=Math.pow(10,this.options.precision);return(parseFloat(this.numberOnly(/\D+/g))/t||0).toFixed(xe(this.options.precision))}toNumber(t){return Number(t)}numberOnly(t){var i;return(i=this.input)==null?void 0:i.toString().replace(this.preSurRegExp,"").replace(t||this.numberRegExp,"")}isNegative(){return this.sign()==="-"}numbers(){const{reverseFill:t,decimal:i}=this.options;return t?this.number=this.toFixed().replace(".",i):typeof this.input=="number"?this.number=this.parts(this.input.toString().replace("-",""),".").join(i):isNaN(this.toNumber(this.input))?this.number=this.parts(this.numberOnly()).join(i):this.number=this.parts(this.input.replace("-",""),".").join(i),this.number}unformatNumber(){return this.numbers().toString().replace(this.options.decimal,".")}realNumber(){return parseFloat(this.unformatNumber())}parts(t,i){const{precision:a,minimumFractionDigits:p,decimal:n}=this.options;let o=t.toString().split(i||n);if(o.length>1&&(o[0]=this.toNumber(o[0])||0,o[1]=o.slice(1,o.length).join(""),o=o.slice(0,2)),this.isClean){const s=this.toNumber(o.join(".")).toFixed(a),m=this.toNumber(s),c=m.toFixed(p);o=p>=0&&m.toString().length<c.length?c.toString().split("."):m.toString().split(".")}return o.slice(0,2)}addSeparator(){const{decimal:t,separator:i}=this.options,a=this.numbers().split(t);return a[0]=a[0].toString().replace(/(\d)(?=(?:\d{3})+\b)/gm,`$1${i}`),a.join(t)}format(t){this.input=t;const{reverseFill:i,nullValue:a,prefix:p,suffix:n}=this.options;return this.isNull()&&!i?a:this.sign()+p+this.addSeparator()+n}unformat(t){this.input=t;const{reverseFill:i,nullValue:a}=this.options,p=this.realNumber(),n=this.unformatNumber();return this.isNull()||i&&p===0?a:this.sign()+n}}const T="-";function Q(e){return JSON.parse(JSON.stringify(e))}function G(e){return new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:{facade:!0}})}function O(e){const t=e instanceof HTMLInputElement?e:e.querySelector("input");if(!t)throw new Error("number directive requires an input element");return t}function K(e,t){const i=()=>{e.setSelectionRange(t,t)};i(),setTimeout(i,1)}function F(e,t,{emit:i=!0,force:a=!1,clean:p=!1}={}){var g;const{options:n,oldValue:o}=e,{reverseFill:s,max:m,min:c}=n,v=((g=t==null?void 0:t.props)==null?void 0:g.value)||e.value;if(a||o!==v){const E=new A(n).clean(p&&!s);let k=E.format(v),x=E.clean(!s).unformat(v);return p&&(Number(m)===m&&Number(x)>m?(k=E.format(m),x=m.toString()):Number(c)===c&&Number(x)<c&&(k=E.format(c),x=c.toString())),e.oldValue=k,e.unmasked=x,e.value!==k&&(e.value=k),i&&e.dispatchEvent(G("input"))}}var ye={beforeMount:(e,{value:t,modifiers:i},a)=>{var m;e=O(e);const p=Object.assign(Q(U),t,i),{reverseFill:n,precision:o,decimal:s}=p;e.options=p,e.setAttribute("inputmode","numeric"),n&&e.value?(e.value=parseFloat(new A({...p,reverseFill:!1}).unformat(e.value)).toFixed(o),(m=a==null?void 0:a.props)!=null&&m.value&&(a.props.value=e.value)):e.value&&!isNaN(Number(e.value))&&(e.value=e.value.replace(".",s)),F(e,a,{force:p.prefill,clean:!0,emit:!1})},mounted:e=>{const t=(e=O(e)).parentElement||e,i=n=>{n.target===e&&function(o){const{target:s,detail:m}=o;if(m!=null&&m.facade)return!1;o.stopPropagation();let c=s.value.length;const{oldValue:v,options:g}=s;s.selectionEnd&&(c=s.value.length-s.selectionEnd),F(s,null,{clean:!g.precision,emit:!1}),g.suffix&&(c=Math.max(c,g.suffix.length)),c=s.value.length-c,g.prefix&&(c=Math.max(c,g.prefix.length)),K(s,c),v!==s.value&&s.dispatchEvent(G("input"))}(n)},a=n=>{n.target===e&&function(o){const{target:s}=o,{oldValue:m}=s;F(s,null,{force:!0,clean:!0,emit:!1}),m!==s.value&&s.dispatchEvent(G("input"))}(n)},p=n=>{n.target===e&&function(o,s){const{options:m}=s,{prefix:c,suffix:v,decimal:g,min:E,separator:k}=m,{key:x}=o,B=new RegExp(`${c}|${v}`,"g"),V=s.value.replace(B,""),M=E===void 0||Number(E)<0||Number(E)!==E;if(x===g)V.includes(g)?o.preventDefault():V||(s.value="0"+g,s.dispatchEvent(new Event("input")));else if(x!==T||M){if(x==="Backspace"){const h=s.selectionEnd||0,l=s.value.slice(h-1,h),w=s.value.slice(h-2,h);let u=s.value.length-h;[c,T,k].includes(l)&&(o.preventDefault(),s.value=l===k?s.value.replace(w,""):s.value.replace(new RegExp(`[${c}${T}]`,"g"),""),u=Math.max(u,v.length),u=s.value.length-u,u=Math.max(u,c.length),K(s,u),s.dispatchEvent(new Event("input")))}}else o.preventDefault()}(n,e)};t.addEventListener("input",i,!0),t.addEventListener("blur",a,!0),t.addEventListener("keydown",p,!0),e.cleanup=()=>{t.removeEventListener("input",i,!0),t.removeEventListener("blur",a,!0),t.removeEventListener("keydown",p,!0)}},updated:(e,{value:t,oldValue:i,modifiers:a},p)=>{if(e=O(e),t!==i){const n=e.options;e.options=Object.assign(n,t,a),F(e,p,{force:!0,clean:!1,emit:!1})}else F(e,p,{emit:!1})},unmounted:e=>{O(e).cleanup()}};const y=Q(U);var W=ee({name:"VueNumber",directives:{number:ye},props:{modelValue:{type:[String,Number],required:!0},nullValue:{type:[Number,String],default:y.nullValue},masked:Boolean,readonly:Boolean,disabled:Boolean,reverseFill:{type:Boolean,default:y.reverseFill},prefill:{type:Boolean,default:y.prefill},precision:{type:Number,default:()=>y.precision},minimumFractionDigits:{type:Number,default:()=>y.minimumFractionDigits},decimal:{type:String,default:()=>y.decimal},min:{type:Number,default:()=>y.min},max:{type:Number,default:()=>y.max},separator:{type:String,default:()=>y.separator},prefix:{type:String,default:()=>y.prefix},suffix:{type:String,default:()=>y.suffix}},emits:["update:model-value","input:model-value"],setup(e,{emit:t}){const i=D(e.modelValue),a=D(!1),p=D(""),n=$(()=>({...e})),o=new A(n.value),s=$(()=>e.masked?o.format(i.value):p.value),m=()=>{t("update:model-value",s.value)};return Y(()=>e.modelValue,c=>{const v=o.format(c);v!==i.value&&(i.value=v)}),{config:n,maskedValue:i,unmaskedValue:p,input:c=>{const{target:v}=c;i.value=v.value,p.value=v.unmasked,a.value=!0,t("input:model-value",s.value)},blur:()=>{a.value&&s.value!==e.modelValue&&m()},change:m}}});const Ee=["value","readonly","disabled"];W.render=function(e,t,i,a,p,n){const o=te("number");return _((f(),b("input",{type:"text",autocomplete:"off",value:e.maskedValue,readonly:e.readonly,disabled:e.disabled,class:"v-number vue-number-format",onChange:t[0]||(t[0]=(...s)=>e.change&&e.change(...s)),onInput:t[1]||(t[1]=(...s)=>e.input&&e.input(...s)),onBlur:t[2]||(t[2]=(...s)=>e.blur&&e.blur(...s))},null,40,Ee)),[[o,e.config]])},W.__file="src/component.vue";const ke={class:"flex flex-col max-w-140"},Ne={class:"grid p-4 gap-2 items-center",style:{"grid-template-columns":"1fr 10fr"}},we={class:"flex-1"},Se={key:1,class:"flex flex-col"},je={class:"font-bold"},Ce={class:"flex flex-wrap gap-3"},Fe=["value"],Ve={class:"p-2 text-right"},Re={key:0,class:"w-full"},Oe={key:1,class:"flex flex-wrap gap-1"},$e=["onClick"],Be={class:"font-bold"},Me={key:2,class:"flex"},Le={class:"overflow-scroll font-mono text-xs m-4 opacity-50 break-all col-span-2"},Ie={__name:"GiftForm",props:{gift:{type:Object,default:()=>({})}},emits:["sent","update:gift"],setup(e,{emit:t}){const i={decimal:".",separator:" ",prefix:"",precision:2,masked:!1},a=e,{user:p}=ae(),{gift:n,cleanGift:o,propose:s,proposed:m,hash:c,valid:v}=ve(a.gift),{guests:g,count:E}=fe(),{project:k}=ge(ne(n,"project")),{projects:x}=he(),B=ue();Y(()=>n.wallet,h=>{h&&(n.ql=h.currency)});const V=$(()=>{const h=pe(),l=J({});return Object.keys(g).forEach(w=>{h.user(w).get("wallets").on((u,L)=>{l[w]=g[w]})}),l}),M=$(()=>{const h=J({});return Object.keys(x).forEach(l=>{l.includes(n.to)&&(h[l]=x[l])}),h});return(h,l)=>{const w=se("gift-wallets");return f(),b("div",ke,[d("div",Ne,[l[15]||(l[15]=d("div",{class:"p-2 text-right"},"FROM",-1)),d("div",we,[r(p).pub?(f(),S(r(q),{key:0,pub:r(p).pub},null,8,["pub"])):(f(),S(r(ce),{key:1}))]),l[16]||(l[16]=d("div",{class:"p-2 text-right"},"TO ",-1)),r(n).to?(f(),S(r(q),{key:0,pub:r(n).to},{default:I(()=>[l[8]||(l[8]=d("div",{class:"flex-1"},null,-1)),d("div",{class:"i-la-times mr-2",onClick:l[0]||(l[0]=u=>{r(n).to="",r(n).wallet=null})})]),_:1},8,["pub"])):(f(),b("div",Se,[d("div",je,"USER SELECT OF "+j(Object.keys(V.value).length),1),d("div",Ce,[(f(!0),b(C,null,P(r(g),u=>(f(),S(r(q),{key:u,pub:u.pub,onClick:L=>r(n).to=u.pub},null,8,["pub","onClick"]))),128))])])),r(n).to?(f(),b(C,{key:2},[l[14]||(l[14]=d("div",{class:"p-2 text-right"},"WALLET",-1)),(f(),S(w,{key:r(n).to,pub:r(n).to,"active-wallet":r(n).wallet,onWallet:l[1]||(l[1]=u=>r(n).wallet=u),onClear:l[2]||(l[2]=u=>r(n).wallet=null)},null,8,["pub","active-wallet"])),r(n).wallet?(f(),b(C,{key:0},[l[10]||(l[10]=d("div",{class:"p-2 text-right"},"Quantity",-1)),z(r(W),ie({modelValue:r(n).qn,"onUpdate:modelValue":l[3]||(l[3]=u=>r(n).qn=u)},i,{placeholder:"Quantity"}),null,16,["modelValue"]),l[11]||(l[11]=d("div",{class:"p-2 text-right"},"Quality",-1)),_(d("select",{class:"rounded-xl dark-bg-dark-100 p-2","onUpdate:modelValue":l[4]||(l[4]=u=>r(n).ql=u),placeholder:"Your account currency"},[(f(!0),b(C,null,P(r(be),u=>(f(),b("option",{key:u,value:u},j(u),9,Fe))),128))],512),[[le,r(n).ql]]),l[12]||(l[12]=d("div",{class:"p-2 text-right self-start"},"Wish ",-1)),_(d("textarea",{class:"p-2","onUpdate:modelValue":l[5]||(l[5]=u=>r(n).wish=u),placeholder:"Wish"},null,512),[[re,r(n).wish]]),d("div",Ve,[l[9]||(l[9]=oe("PROJECT ")),r(n).project?R("",!0):(f(),b("div",Re,"SELECT"))]),r(n).project?(f(),S(r(me),{key:0,project:r(k),path:r(n).project},{default:I(()=>[d("div",{class:"i-la-times",onClick:l[6]||(l[6]=u=>r(n).project=null)})]),_:1},8,["project","path"])):(f(),b("div",Oe,[(f(!0),b(C,null,P(M.value,(u,L)=>(f(),b("div",{class:"p-2 rounded-xl cursor-pointer",key:L,style:H({backgroundColor:u.color}),onClick:De=>r(n).project=u.path},[d("div",Be,j(u.title),1)],12,$e))),128))])),l[13]||(l[13]=d("div",{class:"p-2 text-right"},"ROOM",-1)),z(r(de)),r(v)?(f(),b("div",Me,[d("button",{class:"button w-full justify-center",onClick:l[7]||(l[7]=u=>{r(s)(),h.$emit("sent",r(c))})},"Propose")])):R("",!0),d("pre",Le,j(r(o)),1),d("div",{class:"font-mono text-xs col-span-2 text-center rounded-lg m-2 transition",style:H({backgroundColor:r(B).hex(r(c)||"")})},j(r(c)),5)],64)):R("",!0)],64)):R("",!0)])])}}};export{Ie as default};
