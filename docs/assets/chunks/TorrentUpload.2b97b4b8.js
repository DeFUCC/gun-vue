import{C as w,D as C}from"./theme.10cdc4d6.js";import{E as S,a5 as $,a6 as H,n as U,a as B,I as m}from"./components.5cea098c.js";import"../app.0201bdfc.js";import{d as E,f as v,x as D,o as i,c as p,E as e,t as g,e as o,I as h,G as b,F,U as L,w as R}from"./framework.e76a7413.js";const G={class:"flex flex-col gap-4 p-4"},I={class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer"},N=e("div",{class:"font-bold"},"Share a file via torrent",-1),T=e("div",{class:"flex-1"},null,-1),V={class:"flex flex-wrap gap-2"},Q={key:0,class:"flex flex-col gap-2"},j=e("div",{class:"text-xl"},"Share the torrent",-1),q={class:"font-mono text-sm"},z=["href"],A=e("div",{class:"i-la-link"},null,-1),J=e("div",{class:"p-0"},"Download URL",-1),K=[A,J],M=e("div",{class:"i-la-copy"},null,-1),O={class:"p-0"},P=e("div",{class:"i-la-share"},null,-1),W=e("div",{class:"p-0"}," Share",-1),X=[P,W],ae=E({__name:"TorrentUpload",emits:["uploaded"],setup(Y,{emit:Z}){const l=v();v();function k(a){var d;const{torrent:t}=H((d=a==null?void 0:a.target)==null?void 0:d.files),r=U(),{user:n}=B();R(t,async s=>{var f;l.value=s;const c={infoHash:s.infoHash,length:s.length,name:s.name,author:n.pub};r.user(m.pub).get("files").get(`${c.infoHash}@${n.pub}`).put(c,null,{opt:{cert:(f=m.features)==null?void 0:f.files}})})}const u=D(()=>{var t,r,n;if(!((t=l.value)!=null&&t.infoHash))return"";let a=new URL((r=window==null?void 0:window.location)==null?void 0:r.href);return`${a.protocol}//${a.hostname}${a.port?`:${a.port}`:""}/#/files/${(n=l.value)==null?void 0:n.infoHash}`}),_=w({source:u}),{share:x,isSupported:y}=C();return(a,t)=>{var r,n,d;return i(),p("div",G,[e("label",I,[N,T,e("input",{type:"file",accept:"image/*",onChange:t[0]||(t[0]=s=>k(s))},null,32)]),e("div",V,[l.value?(i(),p("div",Q,[j,e("div",q,g((r=l.value)==null?void 0:r.infoHash),1),e("a",{class:"gap-2 button underline font-bold break-all",href:o(u),target:"_blank"},K,8,z),o(_).isSupported.value?(i(),p("button",{key:0,class:"p-2 button gap-2",onClick:t[1]||(t[1]=s=>o(_).copy())},[M,e("div",O,g((n=o(_))!=null&&n.copied.value?"Copied!":"Copy"),1)])):h("",!0),o(y)?(i(),p("button",{key:1,class:"p-2 button gap-2",onClick:t[2]||(t[2]=s=>{var c;return o(x)({title:(c=l.value)==null?void 0:c.name,url:o(u)})})},X)):h("",!0)])):h("",!0),o(u)?(i(),b(o(S),{key:1,data:o(u)},null,8,["data"])):h("",!0)]),(i(!0),p(F,null,L((d=l.value)==null?void 0:d.files,s=>(i(),b(o($),{key:s==null?void 0:s.name,file:s},null,8,["file"]))),128))])}}});export{ae as default};
