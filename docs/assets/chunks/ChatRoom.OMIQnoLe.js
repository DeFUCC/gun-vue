import"../app.xYDEA0S0.js";import{L as x,K as g,R as k,b as C,T as _,o as l,U as v,V as S,W as w,X as B}from"./components.lsXtGw5O.js";import{d as N,y as V,g as R,o as d,c as U,I as i,w as $,m as t,b as z,e as A,k as c,t as D,O as E}from"./framework.rP7snUOj.js";import"./theme.kNHa_nSU.js";const I={class:"px-4 py-6 flex flex-wrap items-center text-center"},L={class:"flex-1 ml-2 font-bold"},T={class:"p-4 bg-dark-50 bg-opacity-80 flex gap-2 flex sticky bottom-0"},P=N({__name:"ChatRoom",props:{title:{type:String,default:"Topics"},topic:{type:String,default:"general"},clickSound:{type:String,default:"audio/safe.mp3"}},emits:["account"],setup(f,{emit:W}){const u=f;let n;function m(){n||(n=new Audio(u.clickSound),n.volume=.1),n.play()}const{send:b,currentChat:r,sorted:p}=x();V(()=>u.topic,a=>{r.value=a},{immediate:!0}),g(p,(a,s)=>{if(a.length>s.length){m();const e=a.slice(-1)[0],{isSupported:o,notification:H,show:h,close:K,onClick:M,onShow:O,onError:X,onClose:j}=k({title:e==null?void 0:e.text,body:`${e==null?void 0:e.timestamp} by ${e==null?void 0:e.author}`,lang:"en",tag:"chat"});o.value&&h()}},{deep:!0});const y=R(()=>C({pub:_.pub,size:1200}));return(a,s)=>{var e;return d(),U("div",{class:"flex flex-col overflow-y-scroll",style:E([{flex:"1000 1 auto"},{...y.value}])},[i(t(S),{open:!!((e=t(l))!=null&&e.pub),onClose:s[0]||(s[0]=o=>t(l).pub="")},{default:$(()=>{var o;return[(o=t(l))!=null&&o.pub?(d(),z(t(v),{key:0,pub:t(l).pub},null,8,["pub"])):A("",!0)]}),_:1},8,["open"]),c("div",I,[c("div",L,D(t(r)),1)]),i(t(w),{messages:t(p)},null,8,["messages"]),c("div",T,[i(t(B),{class:"flex-auto",onSubmit:s[1]||(s[1]=o=>t(b)(o))})])],4)}}});export{P as default};
