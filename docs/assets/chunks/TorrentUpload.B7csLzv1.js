import{d as F,s as h,h as L,o as l,c,j as e,t as p,k as n,a1 as T,I as y,w as C,e as _,T as V,b as S,F as D,E as N,v as Q}from"./framework._p70gbZ2.js";import{D as R,E as j,ac as q,H as G,ad as I,V as M,ae as z,n as A,a as J}from"./components.C6Mx1Nia.js";import"./theme.e8fDgIKL.js";const K={class:"flex flex-col gap-4 p-4 break-all"},O={key:0,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center"},P=e("div",{class:"font-bold"},"Share a file",-1),W=e("div",{class:"font-bold"},"Sharing a file:",-1),X={class:"text-md max-w-55ch"},Y={class:"flex-1 font-mono text-xs min-w-10"},Z={class:"p-0"},ee={class:"flex flex-wrap gap-2 p-4 items-start"},se={key:0,class:"flex flex-col gap-2"},te=e("div",{class:"text-xl"},"Sharing the torrent",-1),ae={class:"font-mono text-sm"},oe=["href"],le=e("div",{class:"i-la-link"},null,-1),ne=e("div",{class:"p-0"},"Download URL",-1),ie=[le,ne],re=e("div",{class:"i-la-copy"},null,-1),de={class:"p-0"},ue=e("div",{class:"i-la-share"},null,-1),ce=e("div",{class:"p-0"}," Share",-1),pe=[ue,ce],ve=e("div",{class:"i-la-qrcode"},null,-1),fe={class:"p-0"},he=e("div",{class:"i-la-file"},null,-1),_e={class:"p-0"},xe=F({__name:"TorrentUpload",emits:["uploaded"],setup(me,{emit:$}){const H=$,t=h();h();const v=h(!1),m=h(!1),g=h(!1);function U(a){var i;const{torrent:s}=z((i=a==null?void 0:a.target)==null?void 0:i.files);A();const{user:d}=J();Q(s,async u=>{t.value=u,v.value=!0;const o={infoHash:u.infoHash,length:u.length,name:u.name,author:d.pub};H("uploaded",o)})}const f=L(()=>{var s,d,i;if(!((s=t.value)!=null&&s.infoHash))return"";let a=new URL((d=window==null?void 0:window.location)==null?void 0:d.href);return`${a.protocol}//${a.hostname}${a.port?`:${a.port}`:""}/#/files/${(i=t.value)==null?void 0:i.infoHash}`}),k=R({source:f}),{share:B,isSupported:E}=j();return(a,s)=>{var d,i,u;return l(),c("div",K,[t.value?(l(),c("div",{key:1,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center break-all",onClick:s[2]||(s[2]=o=>v.value=!v.value)},[W,e("div",X,p((d=t.value)==null?void 0:d.name),1),e("div",Y,p((i=t.value)==null?void 0:i.infoHash),1),e("div",Z,p(n(q)((u=t.value)==null?void 0:u.length)),1),e("div",{class:"i-la-times",onClick:s[1]||(s[1]=T(o=>t.value=null,["prevent","stop"]))})])):(l(),c("label",O,[P,e("input",{class:"max-w-30",type:"file",accept:"image/*",onChange:s[0]||(s[0]=o=>U(o))},null,32)])),y(n(M),{open:v.value,onClose:s[7]||(s[7]=o=>v.value=!1)},{default:C(()=>{var o,b,x;return[e("div",ee,[t.value?(l(),c("div",se,[te,e("div",ae,p((o=t.value)==null?void 0:o.infoHash),1),e("a",{class:"gap-2 button underline font-bold break-all",href:f.value,target:"_blank"},ie,8,oe),n(k).isSupported.value?(l(),c("button",{key:0,class:"p-2 button gap-2",onClick:s[3]||(s[3]=r=>n(k).copy())},[re,e("div",de,p((b=n(k))!=null&&b.copied.value?"Copied!":"Copy"),1)])):_("",!0),n(E)?(l(),c("button",{key:1,class:"p-2 button gap-2",onClick:s[4]||(s[4]=r=>{var w;return n(B)({title:(w=t.value)==null?void 0:w.name,url:f.value})})},pe)):_("",!0),e("button",{class:"button p-2 gap-2",onClick:s[5]||(s[5]=r=>m.value=!m.value)},[ve,e("div",fe,p(m.value?"Hide":"Show")+" QR ",1)]),e("button",{class:"button p-2 gap-2",onClick:s[6]||(s[6]=r=>g.value=!g.value)},[he,e("div",_e,p(g.value?"Hide":"Show")+" file ",1)])])):_("",!0),y(V,{name:"fade"},{default:C(()=>[f.value&&m.value?(l(),S(n(G),{key:0,data:f.value},null,8,["data"])):_("",!0)]),_:1}),g.value?(l(!0),c(D,{key:1},N((x=t.value)==null?void 0:x.files,r=>(l(),S(n(I),{class:"flex-auto",key:r==null?void 0:r.name,file:r},null,8,["file"]))),128)):_("",!0)])]}),_:1},8,["open"])])}}});export{xe as default};
