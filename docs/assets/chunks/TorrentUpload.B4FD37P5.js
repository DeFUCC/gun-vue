import{p as m,V as T,d as V,h as E,aR as F,aS as D,o,c as v,j as s,t as f,k as n,a0 as G,G as _,w as H,e as g,T as N,b as U,F as Q,C as q,q as I}from"./framework.BtfQKcS5.js";import"./theme.B2FxFXkD.js";import{G as P,a6 as j,U as A,h as M,a as O}from"./components.DbnZk3WN.js";import{p as z}from"./index.BuUnCgYx.js";function J(y){const k=m();return T(()=>import("./webtorrent.min.HcgxlztZ.js"),[]).then(w=>{new w.default().seed(y,function(i){console.log("Client is seeding "+i.magnetURI),k.value=i})}),{torrent:k}}const K={class:"flex flex-col gap-4 p-4 break-all"},W={key:0,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center"},X={class:"text-md max-w-55ch"},Y={class:"flex-1 font-mono text-xs min-w-10"},Z={class:"p-0"},ee={class:"flex flex-wrap gap-2 p-4 items-start"},se={key:0,class:"flex flex-col gap-2"},te={class:"font-mono text-sm"},ae=["href"],le={class:"p-0"},oe={class:"p-0"},ne={class:"p-0"},pe=V({__name:"TorrentUpload",emits:["uploaded"],setup(y,{emit:k}){const w=k,t=m();m();const i=m(!1),b=m(!1),x=m(!1);function R(a){var r;const{torrent:e}=J((r=a==null?void 0:a.target)==null?void 0:r.files);M();const{user:d}=O();I(e,async p=>{t.value=p,i.value=!0;const l={infoHash:p.infoHash,length:p.length,name:p.name,author:d.pub};w("uploaded",l)})}const c=E(()=>{var e,d,r;if(!((e=t.value)!=null&&e.infoHash))return"";let a=new URL((d=window==null?void 0:window.location)==null?void 0:d.href);return`${a.protocol}//${a.hostname}${a.port?`:${a.port}`:""}/#/files/${(r=t.value)==null?void 0:r.infoHash}`}),h=F({source:c}),{share:B,isSupported:L}=D();return(a,e)=>{var d,r,p;return o(),v("div",K,[t.value?(o(),v("div",{key:1,class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer items-center break-all",onClick:e[2]||(e[2]=l=>i.value=!i.value)},[e[9]||(e[9]=s("div",{class:"font-bold"},"Sharing a file:",-1)),s("div",X,f((d=t.value)==null?void 0:d.name),1),s("div",Y,f((r=t.value)==null?void 0:r.infoHash),1),s("div",Z,f(n(z)((p=t.value)==null?void 0:p.length)),1),s("div",{class:"i-la-times",onClick:e[1]||(e[1]=G(l=>t.value=null,["prevent","stop"]))})])):(o(),v("label",W,[e[8]||(e[8]=s("div",{class:"font-bold"},"Share a file",-1)),s("input",{class:"max-w-30",type:"file",accept:"image/*",onChange:e[0]||(e[0]=l=>R(l))},null,32)])),_(n(A),{open:i.value,onClose:e[7]||(e[7]=l=>i.value=!1)},{default:H(()=>{var l,C,S;return[s("div",ee,[t.value?(o(),v("div",se,[e[15]||(e[15]=s("div",{class:"text-xl"},"Sharing the torrent",-1)),s("div",te,f((l=t.value)==null?void 0:l.infoHash),1),s("a",{class:"gap-2 button underline font-bold break-all",href:c.value,target:"_blank"},e[10]||(e[10]=[s("div",{class:"i-la-link"},null,-1),s("div",{class:"p-0"},"Download URL",-1)]),8,ae),n(h).isSupported.value?(o(),v("button",{key:0,class:"p-2 button gap-2",onClick:e[3]||(e[3]=u=>n(h).copy())},[e[11]||(e[11]=s("div",{class:"i-la-copy"},null,-1)),s("div",le,f((C=n(h))!=null&&C.copied.value?"Copied!":"Copy"),1)])):g("",!0),n(L)?(o(),v("button",{key:1,class:"p-2 button gap-2",onClick:e[4]||(e[4]=u=>{var $;return n(B)({title:($=t.value)==null?void 0:$.name,url:c.value})})},e[12]||(e[12]=[s("div",{class:"i-la-share"},null,-1),s("div",{class:"p-0"}," Share",-1)]))):g("",!0),s("button",{class:"button p-2 gap-2",onClick:e[5]||(e[5]=u=>b.value=!b.value)},[e[13]||(e[13]=s("div",{class:"i-la-qrcode"},null,-1)),s("div",oe,f(b.value?"Hide":"Show")+" QR ",1)]),s("button",{class:"button p-2 gap-2",onClick:e[6]||(e[6]=u=>x.value=!x.value)},[e[14]||(e[14]=s("div",{class:"i-la-file"},null,-1)),s("div",ne,f(x.value?"Hide":"Show")+" file ",1)])])):g("",!0),_(N,{name:"fade"},{default:H(()=>[c.value&&b.value?(o(),U(n(P),{key:0,data:c.value},null,8,["data"])):g("",!0)]),_:1}),x.value?(o(!0),v(Q,{key:1},q((S=t.value)==null?void 0:S.files,u=>(o(),U(n(j),{class:"flex-auto",key:u==null?void 0:u.name,file:u},null,8,["file"]))),128)):g("",!0)])]}),_:1},8,["open"])])}}});export{pe as default};
