import{E as w,F as C}from"./theme.f9063172.js";import{E as S,a5 as $,a6 as H,n as U,a as E,I as m}from"./components.42f69420.js";import"../app.a6246997.js";import{d as B,f as v,x as F,o as r,c as p,E as e,t as g,e as i,I as h,G as b,F as L,U as R,w as D}from"./framework.088f8093.js";const G={class:"flex flex-col gap-4 p-4"},I={class:"p-2 flex flex-wrap gap-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer"},N=e("div",{class:"font-bold"},"Share a file via torrent",-1),T=e("div",{class:"flex-1"},null,-1),V={class:"flex flex-wrap gap-2"},Q={key:0,class:"flex flex-col gap-2"},j=e("div",{class:"text-xl"},"Share the torrent",-1),q={class:"font-mono text-sm"},z=["href"],A=e("div",{class:"i-la-link"},null,-1),J=e("div",{class:"p-0"},"Download URL",-1),K=[A,J],M=e("div",{class:"i-la-copy"},null,-1),O={class:"p-0"},P=e("div",{class:"i-la-share"},null,-1),W=e("div",{class:"p-0"}," Share",-1),X=[P,W],ae=B({__name:"TorrentUpload",emits:["uploaded"],setup(Y,{emit:Z}){const l=v();v();function k(o){var d;const{torrent:t}=H((d=o==null?void 0:o.target)==null?void 0:d.files),n=U(),{user:a}=E();D(t,async s=>{var f;l.value=s;const c={infoHash:s.infoHash,length:s.length,name:s.name,author:a.pub};n.user(m.pub).get("files").get(`${c.infoHash}@${a.pub}`).put(c,null,{opt:{cert:(f=m.features)==null?void 0:f.files}})})}const u=F(()=>{var t,n,a;if(!((t=l.value)!=null&&t.infoHash))return"";let o=new URL((n=window==null?void 0:window.location)==null?void 0:n.href);return`${o.protocol}//${o.hostname}${o.port?`:${o.port}`:""}/#/files/${(a=l.value)==null?void 0:a.infoHash}`}),_=w({source:u}),{share:x,isSupported:y}=C();return(o,t)=>{var n,a,d;return r(),p("div",G,[e("label",I,[N,T,e("input",{type:"file",accept:"image/*",onChange:t[0]||(t[0]=s=>k(s))},null,32)]),e("div",V,[l.value?(r(),p("div",Q,[j,e("div",q,g((n=l.value)==null?void 0:n.infoHash),1),e("a",{class:"gap-2 button underline font-bold break-all",href:u.value,target:"_blank"},K,8,z),i(_).isSupported.value?(r(),p("button",{key:0,class:"p-2 button gap-2",onClick:t[1]||(t[1]=s=>i(_).copy())},[M,e("div",O,g((a=i(_))!=null&&a.copied.value?"Copied!":"Copy"),1)])):h("",!0),i(y)?(r(),p("button",{key:1,class:"p-2 button gap-2",onClick:t[2]||(t[2]=s=>{var c;return i(x)({title:(c=l.value)==null?void 0:c.name,url:u.value})})},X)):h("",!0)])):h("",!0),u.value?(r(),b(i(S),{key:1,data:u.value},null,8,["data"])):h("",!0)]),(r(!0),p(L,null,R((d=l.value)==null?void 0:d.files,s=>(r(),b(i($),{key:s==null?void 0:s.name,file:s},null,8,["file"]))),128))])}}});export{ae as default};
