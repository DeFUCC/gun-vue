import{d as P,p as o,v as A,c as b,e as r,k as d,o as p,j as t,b as c,a0 as l,aE as E,aF as S,n as j,P as B}from"./framework.ap9ZVjPY.js";import{p as x,a as D,D as N,E as T,G as K,A as M,S as U,j as V,H as z}from"./components.BlQGn2de.js";import{c as F}from"./usePassKeys.DnXDunY8.js";import"./theme.C3LwlMya.js";import{_ as G}from"./AuthDerive.vue_vue_type_script_setup_true_lang.utn7tNAx.js";import{Z as H}from"./derive.BOnCEPHM.js";const Z={class:"flex items-center"},J={class:"flex flex-col gap-4 mt-4"},L={class:"flex flex-wrap justify-center gap-2"},O=["disabled"],R=["disabled"],q=["disabled"],te=P({__name:"AuthCreate",emits:["back"],setup(I,{emit:Q}){x("deep"),x("light");const{user:k,auth:y}=D(),i=o();o("");const a=o(""),n=o(null),{history:g,undo:w}=N(n);async function v(){n.value=await U.pair()}v();function m(){y(n.value,()=>B(async()=>{await V().user(n.value.pub).get("profile").get("name").once().then()||z("name",a.value||"Noname")}))}async function C(){n.value=await H(JSON.stringify(await F(a.value))),m()}const u=o(null),{focused:$}=T(u);return K(()=>{u.value.active||u.value.focus()}),A(()=>{$.value=!0}),(f,e)=>d(k).is?r("",!0):(p(),b("form",{key:0,class:"flex flex-col items-center flex-1 bg-light-700 dark-bg-dark-200 rounded-3xl shadow-lg text-center py-4 transition duration-300ms ease-in relative",onSubmit:e[9]||(e[9]=l(s=>a.value&&m(),["prevent"]))},[t("button",{class:"button absolute top-0 left-0",onClick:e[0]||(e[0]=s=>f.$emit("back"))},e[10]||(e[10]=[t("div",{class:"i-la-angle-left"},null,-1)])),e[15]||(e[15]=t("div",{class:"text-xl font-bold"},"Create a new account",-1)),e[16]||(e[16]=t("div",{class:"mb-4 mt-2"},"Tap the circle to generate a new key",-1)),t("div",Z,[t("button",{class:"gap-2 button items-center",type:"button",onClick:e[1]||(e[1]=l(s=>d(g).length>2?d(w)():f.$emit("back"),["stop"]))},e[11]||(e[11]=[t("div",{class:"i-la-undo text-2xl"},null,-1)])),n.value?(p(),c(d(M),{key:0,class:"rounded-full shadow-xl border-8",pub:n.value.pub,size:200,onClick:e[2]||(e[2]=l(s=>v(),["stop"]))},null,8,["pub"])):r("",!0),t("button",{class:"gap-2 button items-center",type:"button",onClick:e[3]||(e[3]=l(s=>v(),["stop"]))},e[12]||(e[12]=[t("div",{class:"i-la-dice text-2xl"},null,-1)]))]),t("div",J,[E(t("input",{class:"p-4 rounded-2xl text-center","onUpdate:modelValue":e[4]||(e[4]=s=>a.value=s),ref_key:"input",ref:u,autofocus:"",placeholder:"Enter your name or nickname",autocomplete:"username"},null,512),[[S,a.value]]),t("div",L,[t("button",{class:"gap-2 button items-center",type:"button",disabled:!a.value,onClick:e[5]||(e[5]=l(s=>C(),["stop"]))},e[13]||(e[13]=[t("div",{class:"i-la-fingerprint text-2xl"},null,-1),t("div",{class:"text-sm"},"PassKey",-1)]),8,O),t("button",{class:j(["gap-2 button items-center",{active:i.value}]),type:"button",disabled:!a.value,onClick:e[6]||(e[6]=l(s=>i.value=!i.value,["stop"]))},e[14]||(e[14]=[t("div",{class:"i-la-flask text-2xl"},null,-1),t("div",{class:"text-sm"},"Derive",-1)]),10,R)]),i.value?(p(),c(G,{key:0,onPair:e[7]||(e[7]=s=>n.value=s),onLogin:e[8]||(e[8]=s=>m())})):r("",!0),n.value?(p(),b("button",{key:1,class:"button w-full flex justify-center items-center",disabled:!a.value,type:"submit"},"Authenticate",8,q)):r("",!0)])],32))}});export{te as default};
