import{_ as K,p as r,q as P,c as p,o as v,j as l,e as x,ag as T,n as b,aE as m,aF as g,G as y,k as E,w as L,T as $,a0 as f}from"./framework.ap9ZVjPY.js";import{a as q,x as w,Q as B,y as k,S as G,z as R,B as z,K as J,C as O}from"./components.Cv2JVUi5.js";import{g as U}from"./usePassKeys.DnXDunY8.js";import"./theme.DBm_3uFg.js";import{Z as j}from"./derive.BOnCEPHM.js";const I={class:"flex flex-wrap justify-center my-2 gap-2"},M={key:0,class:"flex"},Z={class:"hidden"},H={class:"flex flex-wrap"},h={__name:"AuthForm",setup(W){const{processFile:C}=R(),o=r("pass"),s=r(),i=r(null),{auth:N}=q();function Q(t){o.value!=t?o.value=t:o.value=null}P(s,async t=>{if(!t)return;typeof t=="string"&&t.includes("#/auth/")&&(t=k(t)),t&&typeof t=="string"&&t.substring(0,3)=="SEA"&&(i.value="");let e=O(t);e!=null&&e.pub&&(e!=null&&e.priv)?(N(e),s.value=null):console.log("No valid pair")});async function F(t=s.value){typeof t=="string"&&t.includes("#/auth/")&&(t=k(t)),s.value=await G.decrypt(t,i.value)}async function S(t){var e;s.value=await z((e=t.target)==null?void 0:e.files)}async function c(t){var a,u;const e=(u=(a=t.target)==null?void 0:a.files)==null?void 0:u[0];if(e)try{const n=await J(e);n!=null&&n.content&&(s.value=n.content)}catch(n){console.error("Failed to extract data from avatar:",n)}}async function V(t){s.value=await C(t)}const d=r(!1);r("");async function A(){let t=await U();console.log(t),s.value=await j(JSON.stringify(t))}async function D(t){var e;s.value=await w((e=t.dataTransfer)==null?void 0:e.files)}return"launchQueue"in window&&window.launchQueue.setConsumer(t=>{var a;const e=(a=t.files)==null?void 0:a[0];e&&e.getFile().then(async u=>{s.value=await w(u)})}),(t,e)=>(v(),p("div",{class:b(["flex flex-col my-4 flex-1 items-center bg-light-700 dark-bg-dark-50 rounded-3xl p-4 shadow-lg border-4 border-dark-100 dark-border-light-100 border-op-0 dark-border-op-0",{"border-op-100 dark-border-op-100":d.value}]),id:"dropzone",onDrop:e[10]||(e[10]=f(a=>{D(a),d.value=!1},["prevent"])),onDragover:e[11]||(e[11]=f(a=>d.value=!0,["prevent"])),onDragleave:e[12]||(e[12]=f(a=>d.value=!1,["prevent"]))},[e[17]||(e[17]=l("div",{class:"font-bold text-xl"},"I already have an account",-1)),e[18]||(e[18]=l("div",{class:"text-md"},"Login with a saved key",-1)),l("div",I,[l("button",{class:"button items-center",onClick:e[0]||(e[0]=a=>A())},e[13]||(e[13]=[l("div",{class:"i-la-fingerprint text-2xl"},null,-1),l("div",{class:"px-2"},"PassKey",-1)])),l("button",{class:b(["button cursor-pointer flex items-center",{active:o.value=="key"}]),onClick:e[1]||(e[1]=a=>Q("key"))},e[14]||(e[14]=[l("div",{class:"i-la-key text-2xl"},null,-1),l("div",{class:"p-1 ml-1 font-bold"},"Text",-1)]),2),e[15]||(e[15]=T('<label class="button cursor-pointer flex items-center" for="qr-input" data-v-95c9ba03><div class="i-la-qrcode text-2xl" data-v-95c9ba03></div><div class="p-1 ml-1 font-bold" data-v-95c9ba03>QR</div></label><label class="button cursor-pointer flex items-center" for="json-input" data-v-95c9ba03><div class="i-la-file-code text-2xl" data-v-95c9ba03></div><div class="p-1 ml-1 font-bold" data-v-95c9ba03>Key</div></label><label class="button cursor-pointer flex items-center" for="png-input" data-v-95c9ba03><div class="i-la-user-circle text-2xl" data-v-95c9ba03></div><div class="p-1 ml-1 font-bold" data-v-95c9ba03>PNG</div></label><label class="button cursor-pointer flex items-center" for="svg-input" data-v-95c9ba03><div class="i-la-user text-2xl" data-v-95c9ba03></div><div class="p-1 ml-1 font-bold" data-v-95c9ba03>SVG</div></label>',4))]),i.value!==null?(v(),p("form",M,[m(l("input",{class:"py-1 px-4 m-1 rounded-xl","onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),autofocus:"",type:"password",autocomplete:"current-password",placeholder:"Enter the password"},null,512),[[g,i.value]]),l("button",{class:"button text-2xl",type:"submit",onClick:e[3]||(e[3]=a=>F())},e[16]||(e[16]=[l("div",{class:"i-la-sign-in-alt text-2xl"},null,-1)]))])):x("",!0),l("div",Z,[y(E(B),{onLoaded:e[4]||(e[4]=a=>s.value=a)}),l("input",{id:"qr-input",type:"file",accept:"image/*",onChange:e[5]||(e[5]=a=>V(a.target.files[0]))},null,32),l("input",{id:"json-input",ref:"file",tabindex:"-1",type:"file",accept:".webkey,application/json",onChange:e[6]||(e[6]=a=>S(a))},null,544),l("input",{id:"png-input",type:"file",accept:"image/png",onChange:e[7]||(e[7]=a=>c(a))},null,32),l("input",{id:"svg-input",type:"file",accept:"image/svg+xml",onChange:e[8]||(e[8]=a=>c(a))},null,32)]),e[19]||(e[19]=l("div",{class:"text-sm opacity-50"},"Drag and drop your file here (PNG, JSON, or QR photo/screenshot)",-1)),l("div",H,[y($,{name:"fade",mode:"out-in",appear:""},{default:L(()=>[o.value=="key"?m((v(),p("textarea",{class:"p-2 text-sm flex-1 w-full dark-bg-dark-200",key:"text","onUpdate:modelValue":e[9]||(e[9]=a=>s.value=a),rows:"6",cols:"40",placeholder:"Paste your key pair here or drag and drop a file"},null,512)),[[g,s.value]]):x("",!0)]),_:1})])],34))}},ae=K(h,[["__scopeId","data-v-95c9ba03"]]);export{ae as default};
