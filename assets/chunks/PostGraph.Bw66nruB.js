import{p as g,i as k,h as x}from"./components.CoWBpgrJ.js";import{f as b}from"./force-graph.BdGAtRY5.js";import{ah as m,v,s as _,c as C,o as w,j as y,r as D}from"./framework.BfubPTv1.js";import"./theme.BYxL-NXy.js";const N={class:"flex"},S={__name:"PostGraph",emits:["post"],setup(j,{emit:u}){const f=u,s=g("deep"),n=k(),l=m({}),c=m([]);n.user(x.pub).get("posts").map().once(async(t,e)=>{let h=e.slice(-87),p=e.slice(0,44),d=e.slice(45,89);for(let r of[p,d]){let a=await n.get("#posts").get(r).then();try{a=JSON.parse(a)}catch{}let o=a;l[r]={hash:r,color:s.hex(r),name:(o==null?void 0:o.title)||(o==null?void 0:o.statement)||r}}c.push({source:p,target:d,emoji:t,author:h})});const i={};return v(()=>{const t=b()(document.getElementById("graph")).nodeId("hash").nodeColor("color").nodeRelSize(4).linkDirectionalArrowLength(6).linkDirectionalArrowRelPos(1).linkLabel("emoji").linkCurvature(e=>i[e.index]=i[e.index]||Math.random()*1-.5).linkColor(e=>s.hex((e==null?void 0:e.author)||0)).linkWidth(e=>2).onNodeDragEnd(e=>{e.fx=e.x,e.fy=e.y}).onNodeClick(e=>{t.centerAt(e.x,e.y,1e3),t.zoom(4,2e3)}).onNodeClick((e,h)=>{f("post",e.hash)});_(()=>t.graphData({nodes:Object.values(l),links:c}))}),(t,e)=>(w(),C("div",N,[e[0]||(e[0]=y("div",{class:"bg-light-100 bg-opacity-70 dark-bg-dark-200 backdrop-blur-md backdrop-filter overflow-hidden max-h-60vh min-h-400",id:"graph"},null,-1)),D(t.$slots,"default")]))}};export{S as default};
