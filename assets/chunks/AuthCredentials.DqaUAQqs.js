import{p as L,h as D,c as u,e as p,k as t,o as d,j as s,G as T,aE as j,aP as F,a0 as M,n as W,w as q,T as V}from"./framework.ap9ZVjPY.js";import{H as B,I as N,a as O,B as G,G as A,Q,S as z}from"./components.B0l348pj.js";import"./theme.B5p3DQ49.js";function J(){const{share:S,isSupported:f}=B();function U(l,o="Bookmark"){return{Win:{content:`[InternetShortcut]
URL=${l}`,extension:".url",mime:"application/internet-shortcut"},Mac:{content:`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>URL</key>
  <string>${l}</string>
</dict>
</plist>`,extension:".webloc",mime:"application/x-apple-plist"},Linux:{content:`[Desktop Entry]
Encoding=UTF-8
Type=Link
Name=${o}
URL=${l}`,extension:".desktop",mime:"application/x-desktop"}}}function b(l,o,a){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&f){S({title:o,text:a.startsWith("text/")?l:"Your key file",files:[new File([l],o,{type:a})]});return}const i=new Blob([l],{type:a}),n=URL.createObjectURL(i),r=document.createElement("a");r.href=n,r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}const k=()=>{var a,i;const l=((i=(a=navigator.userAgentData)==null?void 0:a.platform)==null?void 0:i.toLowerCase())??"",o=navigator.userAgent??"";return l.startsWith("mac")?"Mac":l.startsWith("linux")?"Linux":o.includes("Mac")?"Mac":o.includes("Linux")&&!o.includes("Android")?"Linux":"Windows"};function y(l,o){const a=k(),n=U(l)[a];!(n!=null&&n.content)||!(n!=null&&n.extension)||b(n.content,`${o||"account"}${n.extension}`,n.mime)}function g(l,o,a="png"){fetch(l).then(i=>i.blob()).then(i=>b(i,`${o||"account "+new Date().getDate()}.${a}`,i.type))}function w(l,o,a="webkey"){b(l,`${o||"account "+new Date().getDate()}.${a}`,"application/json")}async function x(l,o,a="png"){if(!f){console.log("Sharing not supported");return}try{const i=await fetch(l).then(r=>r.blob());if(!i){console.error("Failed to create blob from data URL");return}const n=new File([i],`${o||"avatar"}.${a}`,{type:a=="png"?"image/png":"image/svg+xml"});return S({title:o||"Gun-Vue avatar",files:[n]}).catch(r=>console.error("Share failed:",r))}catch(i){console.error("Share preparation failed:",i)}}return{saveLink:y,saveImage:g,saveJson:w,shareImage:x}}const K={class:"flex w-full relative"},Y=["disabled","type"],H={key:0,class:"i-la-eye"},X={key:1,class:"i-la-eye-slash"},Z={key:0,class:"text-sm p-2 op-60 justify-center"},_={class:"flex gap-2 w-full"},ee=["disabled"],te={key:0,class:"flex flex-col items-start"},se={class:"flex gap-2 p-2 text-sm flex-wrap items-center"},ne={key:0,class:"i-la-copy"},le={key:1,class:"i-la-check"},oe={class:"flex gap-2 p-2 text-sm flex-wrap items-center"},ae=["href"],ie={key:0,class:"i-la-copy"},re={key:1,class:"i-la-check"},ue={class:"flex flex-wrap p-2 gap-2 items-center"},de=["src"],ce={class:"p-4 flex flex-col gap-2 items-center",key:"qr"},pe=["disabled"],fe={__name:"AuthCredentials",emits:["close"],setup(S,{emit:f}){const U=f,{text:b,copy:k,copied:y,isSupported:g}=N(),{share:w,isSupported:x}=B(),{saveImage:l,saveJson:o,saveLink:a,shareImage:i}=J(),{user:n}=O(),r=L(""),v=L(!1),C=L(!1),$=L(!1),m=G(async()=>r.value?await z.encrypt(n.pair(),r.value):null),h=D(()=>P(m.value)),I=D(()=>A({pub:n.pub,embed:m.value,svg:!1})),E=D(()=>A({pub:n.pub,embed:m.value,svg:!0,p3:!1}));function P(R="",e="#/auth/"){let c=encodeURIComponent(R);return window.location.origin+window.location.pathname+e+c}return(R,e)=>t(n).is?(d(),u("div",{class:"flex flex-col items-stretcvh gap-2 shadow-lg bg-dark-100 backdrop-blur bg-opacity-60 rounded-xl p-4",key:t(n).is},[s("form",{class:"flex flex-col items-center justify-center gap-2 relative flex-1",onSubmit:e[2]||(e[2]=M(c=>v.value=!0,["prevent","stop"]))},[s("div",K,[j(s("input",{class:"p-4 rounded-xl w-full dark-bg-dark-700 text-center",id:"password","onUpdate:modelValue":e[0]||(e[0]=c=>r.value=c),name:"password",autocomplete:"current-password",disabled:v.value,type:C.value?"text":"password",placeholder:"5+ letters"},null,8,Y),[[F,r.value]]),s("button",{class:"text-xl absolute right-2 top-4 op-40 hover-op-90 transition-800",onClick:e[1]||(e[1]=c=>C.value=!C.value),type:"button"},[C.value?(d(),u("div",X)):(d(),u("div",H))])]),v.value?p("",!0):(d(),u("div",Z,"Set a password to encrypt your key backup")),s("div",_,[v.value?p("",!0):(d(),u("button",{key:0,class:"button items-center flex-1",disabled:r.value.length<5||v.value,type:"submit"},e[14]||(e[14]=[s("div",{class:"i-la-check text-2xl"},null,-1),s("div",{class:"ml-2"},"Set",-1)]),8,ee))])],32),v.value?(d(),u("div",te,[e[24]||(e[24]=s("div",{class:"text-sm p-2 op-60 text-center"},"Save your encrypted key in a secure place. Write down the password. Keep it safe.",-1)),s("div",se,[e[17]||(e[17]=s("div",{class:"i-la-key text-3xl"},null,-1)),t(g)?(d(),u("button",{key:0,class:"button items-center text-2xl",onClick:e[3]||(e[3]=c=>t(k)(t(m)))},[t(y)?(d(),u("div",le)):(d(),u("div",ne))])):p("",!0),s("button",{class:"button items-center",onClick:e[4]||(e[4]=c=>t(o)(t(m),t(n).name))},e[15]||(e[15]=[s("div",{class:"i-la-download text-2xl"},null,-1)])),t(x)?(d(),u("button",{key:1,class:"button items-center text-2xl",onClick:e[5]||(e[5]=c=>t(w)({title:t(n).name||"User",text:t(m)}))},e[16]||(e[16]=[s("div",{class:"i-la-share-square text-2xl"},null,-1)]))):p("",!0)]),s("div",oe,[s("a",{class:"i-la-link text-3xl",href:h.value,target:"_blank"},null,8,ae),t(g)?(d(),u("button",{key:0,class:"button items-center text-2xl",onClick:e[6]||(e[6]=c=>t(k)(h.value))},[t(y)?(d(),u("div",re)):(d(),u("div",ie))])):p("",!0),s("button",{class:W(["flex-1 button items-center",{active:$.value}]),onClick:e[7]||(e[7]=c=>$.value=!$.value)},e[18]||(e[18]=[s("div",{class:"i-la-qrcode text-2xl"},null,-1)]),2),s("button",{class:"button items-center",onClick:e[8]||(e[8]=c=>t(a)(h.value,t(n).name))},e[19]||(e[19]=[s("div",{class:"i-la-download text-2xl"},null,-1)])),t(x)?(d(),u("button",{key:1,class:"button items-center",onClick:e[9]||(e[9]=c=>t(w)({title:t(n).name||"User",text:h.value}))},e[20]||(e[20]=[s("div",{class:"i-la-share-square text-2xl"},null,-1)]))):p("",!0)]),s("div",ue,[s("img",{src:t(A)({pub:t(n).pub,size:35})},null,8,de),s("button",{class:"button items-center",onClick:e[10]||(e[10]=c=>t(l)(I.value,t(n).name,"png"))},e[21]||(e[21]=[s("div",{class:"i-la-image text-2xl"},null,-1)])),s("button",{class:"button items-center",onClick:e[11]||(e[11]=c=>t(l)(E.value,t(n).name,"svg"))},e[22]||(e[22]=[s("div",{class:"i-la-file-image text-2xl"},null,-1)])),t(x)?(d(),u("button",{key:0,class:"button items-center",onClick:e[12]||(e[12]=c=>t(i)(I.value,t(n).name))},e[23]||(e[23]=[s("div",{class:"i-la-share-square text-2xl"},null,-1)]))):p("",!0)])])):p("",!0),T(V,{name:"fade",mode:"out-in"},{default:q(()=>[$.value?(d(),u("div",ce,[T(t(Q),{data:t(m)},null,8,["data"])])):p("",!0)]),_:1}),v.value?(d(),u("button",{key:1,class:"button items-center flex-1 justify-center",onClick:e[13]||(e[13]=c=>{r.value="",v.value=!1,U("close")}),disabled:!r.value||!v.value,type:"button"},e[25]||(e[25]=[s("div",{class:"i-la-check text-2xl"},null,-1),s("div",{class:"ml-2"},"Key pair backed up",-1)]),8,pe)):p("",!0)])):p("",!0)}};export{fe as default};
