import{d as w,p as y,q as h,$,h as _,c as r,o as l,b as d,k as s,G as f,j as o,w as x,e as v,F as B,B as C,T as U}from"./framework.ap9ZVjPY.js";import{a as F,bt as k,bu as R,bv as z,q as L,bw as j,bx as N,an as p,by as P,bz as V}from"./components.Cf6-ENKK.js";import{u as q}from"./useRooms.S0vGzt_h.js";import"./theme.Db1AxbS0.js";import M from"./RoomButton.DOYdytzY.js";import S from"./FileShare.B83e71Xv.js";import T from"./FileInfo.DvQvvO0J.js";import"./useRoomLogo.DSloEo5R.js";import"./useBackground.BcCcXVXb.js";const A={class:"flex flex-col items-center w-full justify-stretch"},E={key:1,class:"flex flex-wrap w-full gap-2 p-0"},G={class:"flex flex-col items-start bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll z-100",style:{flex:"1 1 300px"}},H={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},O={key:0,class:"i-la-angle-down"},D={key:1,class:"i-la-angle-up"},I={class:"flex flex-wrap items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-w-600px max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},J={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl",style:{flex:"1 1 200px"}},K={key:0,class:"i-la-angle-down"},Q={key:1,class:"i-la-angle-up"},ie=w({__name:"UserHome",emits:["room","close","chat","browse"],setup(W,{emit:X}){const{user:i}=F(),g=y(!1);let n;h(()=>i.is,()=>{n&&n.off(),i.db.get("safe").get("saved").on((a,e,t,b)=>{n=b,g.value=a})},{immediate:!0}),$(()=>{n==null||n.off()});const u=k("showChats",!0),m=k("showRooms",!0),c=_(()=>Object.entries(q(i.pub)).filter(([a,e])=>e[i.pub]).map(([a])=>a));return(a,e)=>(l(),r("div",A,[s(i).is?(l(),r("div",E,[f(s(z),{class:"z-1000",onBrowse:e[0]||(e[0]=t=>{a.$emit("browse",t),a.$emit("close")})}),o("div",G,[f(s(j),null,{default:x(()=>[o("button",{class:"button",onClick:e[1]||(e[1]=t=>s(L).pub=s(i).pub)}," Public profile")]),_:1})]),o("div",H,[o("button",{class:"z-100 bg-light-400 dark-bg-dark-700 rounded-xl sticky top-0 items-center w-full flex p-2",onClick:e[2]||(e[2]=t=>u.value=!s(u))},[e[8]||(e[8]=o("div",{class:"font-bold text-lg"},"Messages",-1)),e[9]||(e[9]=o("div",{class:"flex-1"},null,-1)),s(u)?(l(),r("div",O)):(l(),r("div",D))]),s(u)?(l(),d(s(N),{key:0,onChat:e[3]||(e[3]=t=>a.$emit("chat",t))})):v("",!0)]),o("div",I,[s(p)?(l(),d(T,{key:0,file:s(p),onClose:e[4]||(e[4]=t=>p.value=null)},null,8,["file"])):(l(),d(s(P),{key:1,class:"w-full",onFile:e[5]||(e[5]=t=>p.value=t)},{default:x(()=>[f(S)]),_:1}))]),o("div",J,[f(s(V),{onBrowse:e[6]||(e[6]=t=>a.$emit("room",t))}),o("button",{class:"items-center w-full flex px-2 pb-2",onClick:e[7]||(e[7]=t=>m.value=!s(m))},[e[10]||(e[10]=o("div",{class:"font-bold text-lg"},"Starred rooms",-1)),e[11]||(e[11]=o("div",{class:"flex-1"},null,-1)),s(m)?(l(),r("div",K)):(l(),r("div",Q))]),f(U,{name:"fade",mode:"out-in"},{default:x(()=>[s(m)?(l(),r("div",{class:"flex flex-col gap-4",key:s(i).pub},[(l(!0),r(B,null,C(c.value,t=>(l(),d(M,{key:t,pub:t,onBrowse:b=>a.$emit("room",t),panel:!1},null,8,["pub","onBrowse"]))),128))])):v("",!0)]),_:1})])])):(l(),d(s(R),{key:0}))]))}});export{ie as default};
