import{j as u,i as a}from"./components.D6DPPL59.js";import{g as n}from"./composables.E5qeQLyD.js";import{ah as l,h as g}from"./framework.Cf-rbDpz.js";function j(){const c=u(),i=l({});return c.user(a.pub).get(n).map().once((f,s)=>{c.get("#"+n).get(s.slice(0,-88)).once((m,e)=>{try{const t=JSON.parse(m);i[e]=t}catch{}})}),{gifts:i}}function G(c){const i=c.slice(-87),f=u(),s=l({});f.user(i).get(n).map().once((e,t)=>{f.get("#"+n).get(t).once(o=>{try{o=JSON.parse(o),o.project==c&&(s[t]={...o,state:{}},f.user(o.from).get(n).get(t).on(r=>{s[t].state.from=r}),f.user(o.to).get(n).get(t).on(r=>{s[t].state.to=r}))}catch(r){console.log(r)}})});const m=g(()=>{let e={};for(let t in s){let o=s[t];e[o.ql]=e[o.ql]||{list:{},sum:0,from:{}},e[o.ql].list[t]=o}for(let t in e){e[t].sum=0,e[t].from={};for(let o in e[t].list){let r=e[t].list[o];r.state.from&&r.state.to&&(e[t].sum+=Number(r.qn),e[t].from[r.from]=e[t].from[r.from]||0,e[t].from[r.from]+=Number(r.qn))}}return e});return{gifts:s,collections:m}}export{G as a,j as u};
