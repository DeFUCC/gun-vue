import{d as $,p as C,q as h,aj as y,h as B,c as i,o as t,G as n,b as d,w as u,e as x,k as s,j as o,N as U,T as w,F,B as L}from"./framework.BN2VI_cg.js";import{a as S,aS as _,b7 as N,U as R,b8 as j,b9 as M,ba as V,bb as z,ab as p,bc as A,bd as P}from"./components.DHXz-LG9.js";import"./theme.DdZphXP3.js";import T from"./RoomButton.D5rzOoKF.js";import q from"./FileShare.DaGUEdx3.js";import E from"./FileInfo.B4dpt6I_.js";import"./useBackground.DNpZJU5j.js";const G={class:"flex flex-col items-center w-full"},H={key:1,class:"flex flex-wrap w-full gap-2 p-2"},I={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll",style:{flex:"1 1 200px"}},D={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll",style:{flex:"1 1 200px"}},J={key:0,class:"i-la-angle-down"},K={key:1,class:"i-la-angle-up"},O={class:"flex flex-wrap items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-w-600px max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},Q={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl",style:{flex:"1 1 200px"}},W={key:0,class:"i-la-angle-down"},X={key:1,class:"i-la-angle-up"},de=$({__name:"UserHome",emits:["user","room","close","chat","browse"],setup(Y,{emit:Z}){const{user:a}=S();function g(){a.db.get("safe").get("saved").put(!0)}const v=C(!1);h(()=>a.is,()=>{a.db.get("safe").get("saved").on(r=>v.value=r)},{immediate:!0});const m=y("showChats",!0),f=y("showRooms",!0),c=B(()=>_(a.pub));return(r,e)=>(t(),i("div",G,[n(s(R),{open:s(a).is&&!v.value,"close-button":"",onClose:e[1]||(e[1]=l=>g())},{default:u(()=>[v.value?x("",!0):(t(),d(s(N),{key:0},{default:u(()=>[o("button",{class:"button mx-8 justify-center",onClick:e[0]||(e[0]=l=>g())},e[10]||(e[10]=[o("div",{class:"i-la-check"},null,-1),o("div",{class:"ml-2"},"I've stored my user key securely",-1)]))]),_:1}))]),_:1},8,["open"]),s(a).is?(t(),i("div",H,[n(s(M),{onBrowse:e[2]||(e[2]=l=>{r.$emit("browse",l),r.$emit("close")})}),o("div",I,[n(s(V)),o("button",{class:"p-2 rounded-xl font-bold text-lg shadow-md",style:U({backgroundColor:s(a).color}),onClick:e[3]||(e[3]=l=>{r.$emit("user",s(a).pub),r.$emit("close")})}," My public profile",4)]),o("div",D,[o("button",{class:"z-100 bg-light-400 dark-bg-dark-700 rounded-xl sticky top-0 items-center w-full flex p-2",onClick:e[4]||(e[4]=l=>m.value=!s(m))},[e[11]||(e[11]=o("div",{class:"font-bold text-lg"},"Messages",-1)),e[12]||(e[12]=o("div",{class:"flex-1"},null,-1)),s(m)?(t(),i("div",J)):(t(),i("div",K))]),n(w,{name:"fade",mode:"out-in"},{default:u(()=>[s(m)?(t(),d(s(z),{key:0,onChat:e[5]||(e[5]=l=>r.$emit("chat",l))})):x("",!0)]),_:1})]),o("div",O,[s(p)?(t(),d(E,{key:0,file:s(p),onClose:e[6]||(e[6]=l=>p.value=null)},null,8,["file"])):(t(),d(s(A),{key:1,onFile:e[7]||(e[7]=l=>p.value=l)},{default:u(()=>[n(q)]),_:1}))]),o("div",Q,[n(s(P),{onBrowse:e[8]||(e[8]=l=>r.$emit("room",l))}),o("button",{class:"items-center w-full flex px-2 pb-2",onClick:e[9]||(e[9]=l=>f.value=!s(f))},[e[13]||(e[13]=o("div",{class:"font-bold text-lg"},"Starred rooms",-1)),e[14]||(e[14]=o("div",{class:"flex-1"},null,-1)),s(f)?(t(),i("div",W)):(t(),i("div",X))]),n(w,{name:"fade",mode:"out-in"},{default:u(()=>{var l,k;return[s(f)?(t(),i("div",{class:"flex flex-col gap-4",key:s(a).pub},[(t(!0),i(F,null,L((k=(l=c.value)==null?void 0:l.rooms)==null?void 0:k.value,(ee,b)=>(t(),d(T,{key:b,pub:b,onBrowse:se=>r.$emit("room",b),panel:!1},null,8,["pub","onBrowse"]))),128))])):x("",!0)]}),_:1})])])):(t(),d(s(j),{key:0}))]))}});export{de as default};
