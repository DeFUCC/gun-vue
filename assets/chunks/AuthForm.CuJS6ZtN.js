import{_ as h,p as d,q as E,c as u,o as c,j as l,e as v,ag as T,aD as m,aE as g,G as x,k as q,w as A,T as O}from"./framework.Cn0LGHOD.js";import{a as R,Q as $,x as y,S as j,y as b,$ as k,z as B}from"./components.dqDRA8lG.js";import{u as J}from"./useQR.CzlV5X_u.js";import"./theme.KpIl4si9.js";const U={class:"flex flex-wrap justify-center"},z={key:0,class:"flex"},I={class:"hidden"},M={class:"flex flex-wrap"},W={__name:"AuthForm",setup(H){const{processFile:w}=J(),r=d("pass"),s=d(),i=d(null),{auth:D}=R();function N(t){r.value!=t?r.value=t:r.value=null}E(s,async t=>{if(!t)return;typeof t=="string"&&t.includes("#/auth/")&&(t=y(t)),t&&typeof t=="string"&&t.substring(0,3)=="SEA"&&(i.value="");let e=B(t);e!=null&&e.pub&&(e!=null&&e.priv)?(D(e),s.value=null):console.log("No valid pair")});async function C(t=s.value){typeof t=="string"&&t.includes("#/auth/")&&(t=y(t)),s.value=await j.decrypt(t,i.value)}function L(t){var e;b((e=t.target)==null?void 0:e.files,a=>s.value=a)}async function P(t){var a,o;const e=(o=(a=t.target)==null?void 0:a.files)==null?void 0:o[0];if(e)try{const n=await k(e);n!=null&&n.content&&(s.value=n.content)}catch(n){console.error("Failed to extract data from PNG:",n)}}function f(t){w(t,e=>s.value=e)}async function F(t){const e=t[0];if(!e)return;const a=e.type.toLowerCase();if(a==="application/json")b([e],o=>s.value=o);else if(a==="image/png")try{const o=await k(e);o!=null&&o.content&&(s.value=o.content)}catch(o){console.error("Failed to extract data from PNG:",o)}else a.startsWith("image/")&&f(e)}function S(t){var a;t.preventDefault();const e=(a=t.dataTransfer)==null?void 0:a.files;e!=null&&e.length&&F(e),p()}function G(t){t.preventDefault(),V()}function Q(t){t.preventDefault(),p()}function V(){document.body.classList.add("dragging")}function p(){document.body.classList.remove("dragging")}return(t,e)=>(c(),u("div",{class:"flex flex-col my-4 flex-1 items-center bg-light-700 dark-bg-dark-50 rounded-3xl p-4 shadow-lg",id:"dropzone",onDrop:S,onDragover:G,onDragleave:Q},[e[11]||(e[11]=l("div",{class:"font-bold text-xl"},"I already have an account",-1)),e[12]||(e[12]=l("div",{class:"text-md"},"Login with a saved key",-1)),e[13]||(e[13]=l("div",{class:"text-sm opacity-50 my-2"},"Drag and drop your key file here (PNG, JSON, or QR image)",-1)),l("div",U,[l("button",{class:"button m-2 cursor-pointer flex items-center",onClick:e[0]||(e[0]=a=>N("key"))},e[8]||(e[8]=[l("div",{class:"i-la-key text-xl"},null,-1),l("div",{class:"p-1 ml-1 font-bold"},"Paste",-1)])),e[9]||(e[9]=T('<label class="button m-2 cursor-pointer flex items-center" for="qr-input" data-v-06276c8d><div class="i-la-qrcode text-xl" data-v-06276c8d></div><div class="p-1 ml-1 font-bold" data-v-06276c8d>QR</div></label><label class="button m-2 cursor-pointer flex items-center" for="json-input" data-v-06276c8d><div class="i-la-file-code text-xl" data-v-06276c8d></div><div class="p-1 ml-1 font-bold" data-v-06276c8d>JSON</div></label><label class="button m-2 cursor-pointer flex items-center" for="png-input" data-v-06276c8d><div class="i-la-user-circle text-xl" data-v-06276c8d></div><div class="p-1 ml-1 font-bold" data-v-06276c8d>PNG</div></label>',3))]),i.value!==null?(c(),u("form",z,[m(l("input",{class:"py-1 px-4 m-1 rounded-xl","onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),autofocus:"",type:"password",autocomplete:"current-password",placeholder:"Enter the password"},null,512),[[g,i.value]]),l("button",{class:"button text-2xl",type:"submit",onClick:e[2]||(e[2]=a=>C())},e[10]||(e[10]=[l("div",{class:"i-la-sign-in-alt"},null,-1)]))])):v("",!0),l("div",I,[x(q($),{onLoaded:e[3]||(e[3]=a=>s.value=a)}),l("input",{id:"qr-input",type:"file",accept:"image/*",onChange:e[4]||(e[4]=a=>f(a.target.files[0]))},null,32),l("input",{id:"json-input",ref:"file",tabindex:"-1",type:"file",accept:"application/json",onChange:e[5]||(e[5]=a=>L(a))},null,544),l("input",{id:"png-input",type:"file",accept:"image/png",onChange:e[6]||(e[6]=a=>P(a))},null,32)]),l("div",M,[x(O,{name:"fade",mode:"out-in",appear:""},{default:A(()=>[r.value=="key"?m((c(),u("textarea",{class:"p-2 text-sm flex-1 w-full dark-bg-dark-200",key:"text","onUpdate:modelValue":e[7]||(e[7]=a=>s.value=a),rows:"6",cols:"40",placeholder:"Paste your key pair here or drag and drop a file"},null,512)),[[g,s.value]]):v("",!0)]),_:1})])],32))}},_=h(W,[["__scopeId","data-v-06276c8d"]]);export{_ as default};
