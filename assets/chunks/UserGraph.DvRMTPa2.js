import{h as p,i as h,x as m}from"./components.BfL1cQFx.js";import{x as f,aj as d,h as b,p as g,y as k,bf as v,c as w,o as x,j as _}from"./framework.DOfjDz1B.js";import{a as j}from"./useMates.DCRW0Ss7.js";import{f as y}from"./force-graph.-gFrwpU5.js";import"./theme.2Mja-hgs.js";const C={class:"bg-light-700 dark-bg-dark-500 overflow-none max-w-100vw max-h-100svh w-full h-full"},z={__name:"UserGraph",emits:["user"],setup(D,{emit:c}){const s=f(null),u=c,n=p(),a=d({});n.user(h.pub).get("space").map().once(async(e,r)=>{a[r]={pub:r,name:await n.user(r).get("profile").get("name").then(),color:"green",links:j(r)}});const i=b(()=>{let e=[];return Object.values(a).forEach(r=>{Object.entries(r.links).forEach(t=>{!a[t[0]]||!t[1].text||e.push({source:r.pub,target:t[0],emoji:t[1].emoji,back:t[1].back})})}),e}),o=y().width(600).nodeId("pub").nodeColor("color").nodeVal(e=>e.pub==m.pub?10:1).nodeRelSize(4).linkDirectionalArrowLength(4).linkDirectionalArrowRelPos(1).linkLabel("emoji").linkCurvature(.2).linkColor(e=>{var r;return colorDeep.hex(((r=e.source)==null?void 0:r.pub)||0)}).linkWidth(e=>e.back?3:1).onNodeDragEnd(e=>{e.fx=e.x,e.fy=e.y}).onNodeClick(e=>{o.centerAt(e.x,e.y,1e3),o.zoom(4,2e3)}).onNodeClick(e=>{u("user",e.pub)});return g(()=>{o(s.value)}),k(()=>o.graphData({nodes:Object.values(a),links:i.value})),v(s,e=>{const r=e[0],{width:t,height:l}=r.contentRect;o.width(t),o.height(l)}),(e,r)=>(x(),w("div",C,[_("div",{id:"graph",ref_key:"graph",ref:s},null,512)]))}};export{z as default};
