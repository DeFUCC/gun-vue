import{_ as $,p as d,q as L,c as f,o as c,r as U,j as l,e as x,G as m,a as q,ag as B,n as g,aE as y,aF as b,k as R,w as z,T as G,a0 as p}from"./framework.ap9ZVjPY.js";import{a as K,x as w,Q as M,y as k,S as P,z as Y,B as j,Y as H,C as I}from"./components.B1Gw4HcJ.js";import{Z as C,v as Z,m as J,w as S}from"./english.CNr916y2.js";import"./theme.BE1TR317.js";const O={class:"flex flex-wrap justify-center my-2 gap-2"},h={key:0,class:"flex"},W={class:"hidden"},X={__name:"AuthForm",setup(_){const{processFile:V}=Y(),o=d("pass"),s=d(),i=d(null),{auth:A}=K();function F(t){o.value!=t?o.value=t:o.value=null}L(s,async t=>{if(!t)return;if(typeof t=="string"&&t.includes("#/auth/")&&(t=k(t)),t&&typeof t=="string"&&t.substring(0,3)=="SEA"&&(i.value=""),t&&typeof t=="string"&&Z(t.trim(),S)){const a=J(t.trim(),S);t=await C(btoa(String.fromCharCode(...a)))}let e=I(t);e!=null&&e.pub&&(e!=null&&e.priv)?(A(e),s.value=null):console.log("No valid pair")});async function N(t=s.value){typeof t=="string"&&t.includes("#/auth/")&&(t=k(t)),s.value=await P.decrypt(t,i.value)}async function Q(t){var e;s.value=await j((e=t.target)==null?void 0:e.files)}async function v(t){var a,r;const e=(r=(a=t.target)==null?void 0:a.files)==null?void 0:r[0];if(e)try{const n=await H(e);n!=null&&n.content&&(s.value=n.content)}catch(n){console.error("Failed to extract data from avatar:",n)}}async function T(t){s.value=await V(t)}const u=d(!1);d("");async function D(){let t=await navigator.credentials.get({publicKey:{challenge:crypto.getRandomValues(new Uint8Array(32)),userVerification:"preferred",timeout:6e4}}),e=new Uint8Array(await crypto.subtle.digest("SHA-256",t.rawId)).slice(0,20);s.value=await C(btoa(String.fromCharCode(...e)))}async function E(t){var e;s.value=await w((e=t.dataTransfer)==null?void 0:e.files)}return"launchQueue"in window&&window.launchQueue.setConsumer(async t=>{var a;const e=(a=t.files)==null?void 0:a[0];if(e){const r=await e.getFile();console.log("loading",r),s.value=await w([r])}}),(t,e)=>(c(),f("div",{class:g(["flex flex-col gap-4 flex-1 items-center bg-light-700 dark-bg-dark-50 rounded-3xl p-4 shadow-lg border-4 border-dark-100 dark-border-light-100 border-op-0 dark-border-op-0",{"border-op-100 dark-border-op-100":u.value}]),id:"dropzone",onDrop:e[10]||(e[10]=p(a=>{E(a),u.value=!1},["prevent"])),onDragover:e[11]||(e[11]=p(a=>u.value=!0,["prevent"])),onDragleave:e[12]||(e[12]=p(a=>u.value=!1,["prevent"]))},[U(t.$slots,"default",{class:"text-md"},()=>[e[13]||(e[13]=q("Login with a saved key"))],!0),l("div",O,[l("button",{class:g(["flex-1 button cursor-pointer flex items-center",{active:o.value=="key"}]),onClick:e[0]||(e[0]=a=>F("key"))},e[14]||(e[14]=[l("div",{class:"i-la-key text-4xl"},null,-1),l("div",{class:"p-1 ml-1 font-bold"},"Text",-1)]),2),l("button",{class:"flex-1 button items-center",onClick:e[1]||(e[1]=a=>D())},e[15]||(e[15]=[l("div",{class:"i-la-fingerprint text-4xl"},null,-1),l("div",{class:"px-2"},"PassKey",-1)])),e[16]||(e[16]=B('<label class="flex-1 button cursor-pointer flex items-center" for="qr-input" data-v-ceeefdc7><div class="i-la-qrcode text-4xl" data-v-ceeefdc7></div><div class="p-1 ml-1 font-bold" data-v-ceeefdc7>QR</div></label><label class="flex-1 button cursor-pointer flex items-center" for="json-input" data-v-ceeefdc7><div class="i-la-file-code text-4xl" data-v-ceeefdc7></div><div class="p-1 ml-1 font-bold" data-v-ceeefdc7>File</div></label><label class="flex-1 button cursor-pointer flex items-center" for="png-input" data-v-ceeefdc7><div class="i-la-user-circle text-4xl" data-v-ceeefdc7></div><div class="p-1 ml-1 font-bold" data-v-ceeefdc7>PNG</div></label><label class="flex-1 button cursor-pointer flex items-center" for="svg-input" data-v-ceeefdc7><div class="i-la-user text-4xl" data-v-ceeefdc7></div><div class="p-1 ml-1 font-bold" data-v-ceeefdc7>SVG</div></label>',4))]),i.value!==null?(c(),f("form",h,[y(l("input",{class:"py-3 px-4 m-4 rounded-xl text-xl text-center","onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),autofocus:"",type:"password",autocomplete:"current-password",placeholder:"Enter the password"},null,512),[[b,i.value]]),l("button",{class:"button text-4xl",type:"submit",onClick:e[3]||(e[3]=a=>N())},e[17]||(e[17]=[l("div",{class:"i-la-sign-in-alt text-4xl"},null,-1)]))])):x("",!0),l("div",W,[m(R(M),{onLoaded:e[4]||(e[4]=a=>s.value=a)}),l("input",{id:"qr-input",type:"file",accept:"image/*",onChange:e[5]||(e[5]=a=>T(a.target.files[0]))},null,32),l("input",{id:"json-input",ref:"file",tabindex:"-1",type:"file",accept:".webkey,application/json",onChange:e[6]||(e[6]=a=>Q(a))},null,544),l("input",{id:"png-input",type:"file",accept:"image/png",onChange:e[7]||(e[7]=a=>v(a))},null,32),l("input",{id:"svg-input",type:"file",accept:"image/svg+xml",onChange:e[8]||(e[8]=a=>v(a))},null,32)]),e[18]||(e[18]=l("div",{class:"text-sm opacity-50"},"Drag and drop your key file here",-1)),m(G,{name:"fade",mode:"out-in",appear:""},{default:z(()=>[o.value=="key"?y((c(),f("textarea",{class:"p-2 text-sm flex-1 w-full dark-bg-dark-200",key:"text","onUpdate:modelValue":e[9]||(e[9]=a=>s.value=a),rows:"6",cols:"40",placeholder:"Your seed phrase or your keypair"},null,512)),[[b,s.value]]):x("",!0)]),_:1})],34))}},se=$(X,[["__scopeId","data-v-ceeefdc7"]]);export{se as default};
