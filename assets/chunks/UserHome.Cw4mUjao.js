import{d as c,p as w,q as y,h as $,c as r,o as l,G as n,b as u,w as d,e as b,k as s,j as o,F as C,B as h,T as B}from"./framework.BoVd_Pm6.js";import{a as U,bp as k,bq as _,af as F,br as L,bs as R,q as j,bt as q,bu as N,ai as p,bv as P,bw as S}from"./components.B1jSCJNL.js";import{u as V}from"./useRooms.B6Cr0IZv.js";import"./theme.CpRZ4BpD.js";import z from"./RoomButton.DvAxAAgP.js";import A from"./FileShare.Dtk1Y4jX.js";import M from"./FileInfo.B989QLCp.js";import"./useRoomLogo.p5HWI3bc.js";import"./useBackground.BOo4T57j.js";const T={class:"flex flex-col items-center w-full justify-stretch"},E={key:1,class:"flex flex-wrap w-full gap-2 p-0"},G={class:"flex flex-col items-start bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},H={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},I={key:0,class:"i-la-angle-down"},O={key:1,class:"i-la-angle-up"},D={class:"flex flex-wrap items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl max-w-600px max-h-40vh overflow-y-scroll",style:{flex:"1 1 300px"}},J={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl",style:{flex:"1 1 200px"}},K={key:0,class:"i-la-angle-down"},Q={key:1,class:"i-la-angle-up"},ne=c({__name:"UserHome",emits:["room","close","chat","browse"],setup(W,{emit:X}){const{user:a}=U();function x(){a.db.get("safe").get("saved").put(!0)}const v=w(!1);y(()=>a.is,()=>{a.db.get("safe").get("saved").on(i=>v.value=i)},{immediate:!0});const f=k("showChats",!0),m=k("showRooms",!0),g=$(()=>Object.entries(V(a.pub)).filter(([i,e])=>e[a.pub]).map(([i])=>i));return(i,e)=>(l(),r("div",T,[n(s(F),{open:s(a).is&&!v.value,"close-button":"",onClose:e[1]||(e[1]=t=>x())},{default:d(()=>[v.value?b("",!0):(l(),u(s(_),{key:s(a).is},{default:d(()=>[o("button",{class:"button mx-8 justify-center",onClick:e[0]||(e[0]=t=>x())},e[10]||(e[10]=[o("div",{class:"i-la-check"},null,-1),o("div",{class:"ml-2"},"I've stored my user key securely",-1)]))]),_:1}))]),_:1},8,["open"]),s(a).is?(l(),r("div",E,[n(s(R),{class:"sticky top-0 z-1000",onBrowse:e[2]||(e[2]=t=>{i.$emit("browse",t),i.$emit("close")})}),o("div",G,[n(s(q),null,{default:d(()=>[o("button",{class:"button",onClick:e[3]||(e[3]=t=>s(j).pub=s(a).pub)}," Public profile")]),_:1})]),o("div",H,[o("button",{class:"z-100 bg-light-400 dark-bg-dark-700 rounded-xl sticky top-0 items-center w-full flex p-2",onClick:e[4]||(e[4]=t=>f.value=!s(f))},[e[11]||(e[11]=o("div",{class:"font-bold text-lg"},"Messages",-1)),e[12]||(e[12]=o("div",{class:"flex-1"},null,-1)),s(f)?(l(),r("div",I)):(l(),r("div",O))]),s(f)?(l(),u(s(N),{key:0,onChat:e[5]||(e[5]=t=>i.$emit("chat",t))})):b("",!0)]),o("div",D,[s(p)?(l(),u(M,{key:0,file:s(p),onClose:e[6]||(e[6]=t=>p.value=null)},null,8,["file"])):(l(),u(s(P),{key:1,class:"w-full",onFile:e[7]||(e[7]=t=>p.value=t)},{default:d(()=>[n(A)]),_:1}))]),o("div",J,[n(s(S),{onBrowse:e[8]||(e[8]=t=>i.$emit("room",t))}),o("button",{class:"items-center w-full flex px-2 pb-2",onClick:e[9]||(e[9]=t=>m.value=!s(m))},[e[13]||(e[13]=o("div",{class:"font-bold text-lg"},"Starred rooms",-1)),e[14]||(e[14]=o("div",{class:"flex-1"},null,-1)),s(m)?(l(),r("div",K)):(l(),r("div",Q))]),n(B,{name:"fade",mode:"out-in"},{default:d(()=>[s(m)?(l(),r("div",{class:"flex flex-col gap-4",key:s(a).pub},[(l(!0),r(C,null,h(g.value,t=>(l(),u(z,{key:t,pub:t,onBrowse:Y=>i.$emit("room",t),panel:!1},null,8,["pub","onBrowse"]))),128))])):b("",!0)]),_:1})])])):(l(),u(s(L),{key:0}))]))}});export{ne as default};
