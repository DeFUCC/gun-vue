const r=e=>btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),n=()=>crypto.getRandomValues(new Uint8Array(32)),o=()=>crypto.getRandomValues(new Uint8Array(16));async function s(e){const t=e||`User ${new Date().toISOString().replace("T"," ").slice(0,16)}`,a={challenge:n(),rp:{name:"Gun-Vue"},user:{id:o(),name:t,displayName:t},pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{residentKey:"required",userVerification:"preferred"},attestation:"none",timeout:6e4},i=await navigator.credentials.create({publicKey:a});return{id:r(new Uint8Array(i.rawId))}}async function l(){const e={challenge:n(),userVerification:"preferred",timeout:6e4},t=await navigator.credentials.get({publicKey:e});return{id:r(new Uint8Array(t.rawId))}}export{s as c,l as g};
