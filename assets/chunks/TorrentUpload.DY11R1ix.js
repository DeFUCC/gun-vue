import{p,v as V,h as M,aR as O,aS as P,c as u,o as n,j as s,G as c,a0 as b,n as j,t as r,k as t,w,F as H,B as U,e as f,T as q,b as D}from"./framework.BfubPTv1.js";import{a9 as E,U as T,H as G,aa as A}from"./components.Cm3H2t8i.js";import"./theme.D56HEEaE.js";import{p as I}from"./index.BuUnCgYx.js";const J={class:"flex gap-2"},K={class:"text-sm"},W={class:"flex flex-col gap-2 p-4"},X={class:"flex flex-col gap-2"},Y={class:"flex items-center gap-2"},Z=["onClick"],_={class:"text-md max-w-55ch"},ll={class:"p-0"},sl=["onClick"],el={key:0,class:"flex max-w-80vw flex-wrap gap-2 p-4 items-start"},tl={class:"flex flex-col gap-2"},ol={class:"text-xl"},al={class:"font-mono text-sm"},nl=["href"],il={class:"p-0"},ul={class:"p-0"},rl={class:"p-0"},dl={key:0,class:"flex gap-2 mt-2"},xl={__name:"TorrentUpload",emits:["uploaded","url"],setup(vl,{emit:L}){const{files:y,upload:R,deleteFile:h,init:z,clearFiles:S,clearOPFS:$}=E(),k=p(!1),a=p(null),m=p(!1),F=L;V(z);async function B(i){var o,d;const l=((o=i.target)==null?void 0:o.files)||((d=i==null?void 0:i.dataTransfer)==null?void 0:d.files);if(!(l!=null&&l.length))return;const e=await R(l);e.length&&(a.value=e[0],F("uploaded",e[0]),F("url",v.value))}const v=M(()=>{var l,e,o;if(!((e=(l=a.value)==null?void 0:l.info)!=null&&e.infoHash))return"";let i=new URL((o=window==null?void 0:window.location)==null?void 0:o.href);return i.hash="",`${i.href}#/files/${a.value.info.infoHash}`}),C=O({source:v}),{share:N,isSupported:Q}=P(),g=p(!1),x=p(!1);return(i,l)=>(n(),u("div",J,[s("label",{class:j(["button",{"bg-light-800":m.value}]),onDragover:l[0]||(l[0]=b(e=>m.value=!0,["prevent"])),onDragleave:l[1]||(l[1]=b(e=>m.value=!1,["prevent"])),onDrop:l[2]||(l[2]=b(e=>{B(e),m.value=!1},["prevent"]))},[l[12]||(l[12]=s("div",{class:"i-la-file-upload"},null,-1)),s("input",{type:"file",accept:"*",multiple:"",onChange:B,style:{display:"none"}},null,32)],34),s("button",{class:"button",onClick:l[3]||(l[3]=e=>k.value=!0)},[l[13]||(l[13]=s("div",{class:"i-la-share"},null,-1)),s("div",K,r(t(y).size),1)]),c(t(T),{open:k.value,onClose:l[6]||(l[6]=e=>k.value=!1)},{default:w(()=>[s("div",W,[s("div",X,[s("div",Y,[l[16]||(l[16]=s("div",{class:"text-xl font-bold"},"Shared files",-1)),l[17]||(l[17]=s("div",{class:"flex-1"},null,-1)),s("button",{class:"button p-2 gap-2",onClick:l[4]||(l[4]=(...e)=>t(S)&&t(S)(...e))},l[14]||(l[14]=[s("div",{class:"i-la-folder-minus"},null,-1),s("div",{class:"p-0"},"Clear files",-1)])),s("button",{class:"button p-2 gap-2",onClick:l[5]||(l[5]=(...e)=>t($)&&t($)(...e))},l[15]||(l[15]=[s("div",{class:"i-la-trash"},null,-1),s("div",{class:"p-0"},"Clear OPFS",-1)]))])]),(n(!0),u(H,null,U(t(y),([e,o])=>(n(),u("div",{key:e,class:"flex gap-2 items-center p-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer",onClick:d=>a.value=o},[s("div",_,r(e),1),l[19]||(l[19]=s("div",{class:"flex-1"},null,-1)),s("div",ll,r(t(I)(o.file.size)),1),s("button",{class:"p-2",onClick:b(d=>t(h)(e),["stop"])},l[18]||(l[18]=[s("div",{class:"i-la-trash"},null,-1)]),8,sl)],8,Z))),128))])]),_:1},8,["open"]),c(t(T),{open:!!a.value,onClose:l[11]||(l[11]=e=>a.value=null)},{default:w(()=>{var e;return[a.value?(n(),u("div",el,[s("div",tl,[s("div",ol,r(a.value.info.name),1),s("div",al,r(a.value.info.infoHash),1),s("a",{class:"gap-2 button underline font-bold -all",href:v.value,target:"_blank"},l[20]||(l[20]=[s("div",{class:"i-la-link"},null,-1),s("div",{class:"p-0"},"Download URL",-1)]),8,nl),t(C).isSupported.value?(n(),u("button",{key:0,class:"p-2 button gap-2",onClick:l[7]||(l[7]=o=>t(C).copy())},[l[21]||(l[21]=s("div",{class:"i-la-copy"},null,-1)),s("div",il,r((e=t(C))!=null&&e.copied.value?"Copied!":"Copy"),1)])):f("",!0),t(Q)?(n(),u("button",{key:1,class:"p-2 button gap-2",onClick:l[8]||(l[8]=o=>{var d;return t(N)({title:(d=a.value.info)==null?void 0:d.name,url:v.value})})},l[22]||(l[22]=[s("div",{class:"i-la-share"},null,-1),s("div",{class:"p-0"}," Share",-1)]))):f("",!0),s("button",{class:"button p-2 gap-2",onClick:l[9]||(l[9]=o=>g.value=!g.value)},[l[23]||(l[23]=s("div",{class:"i-la-qrcode"},null,-1)),s("div",ul,r(g.value?"Hide":"Show")+" QR ",1)]),s("button",{class:"button p-2 gap-2",onClick:l[10]||(l[10]=o=>x.value=!x.value)},[l[24]||(l[24]=s("div",{class:"i-la-file"},null,-1)),s("div",rl,r(x.value?"Hide":"Show")+" file",1)])]),c(q,{name:"fade"},{default:w(()=>[v.value&&g.value?(n(),D(t(G),{key:0,data:v.value},null,8,["data"])):f("",!0)]),_:1}),x.value?(n(),u("div",dl,[(n(!0),u(H,null,U(a.value.torrent.files,o=>(n(),D(t(A),{class:"flex-auto max-w-70 break-all",key:o.name,file:o},null,8,["file"]))),128))])):f("",!0)])):f("",!0)]}),_:1},8,["open"])]))}};export{xl as default};
