import{p as A,h as P,c as a,e as v,k as s,o as r,j as t,G as y,r as q,t as w,N as J,n as x,w as h,T as U,F as W,B as I}from"./framework.BoVd_Pm6.js";import{G as E,a as M,H as K,I as Q,D as Y,J as z,K as H}from"./components.DDidTy9E.js";import"./theme.BlSwDMow.js";import{u as X}from"./useWebAuthn.33aIaTgM.js";function Z(){const{share:C,isSupported:$}=E();function S(n,o="Bookmark"){return{Win:{content:`[InternetShortcut]
URL=${n}`,extension:".url",mime:"application/internet-shortcut"},Mac:{content:`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>URL</key>
  <string>${n}</string>
</dict>
</plist>`,extension:".webloc",mime:"application/x-apple-plist"},Linux:{content:`[Desktop Entry]
Encoding=UTF-8
Type=Link
Name=${o}
URL=${n}`,extension:".desktop",mime:"application/x-desktop"}}}function u(n,o,l){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&$){C({title:o,text:l.startsWith("text/")?n:"Your key file",files:[new File([n],o,{type:l})]});return}const f=new Blob([n],{type:l}),i=URL.createObjectURL(f),c=document.createElement("a");c.href=i,c.download=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i)}return{saveLink:(n,o,l)=>{const i=S(n)[o];!(i!=null&&i.content)||!(i!=null&&i.extension)||u(i.content,`${l||"account"}${i.extension}`,i.mime)},savePng:(n,o)=>{fetch(n).then(l=>l.blob()).then(l=>u(l,`${o||"avatar"}.png`,l.type))},saveJson:(n,o)=>{u(JSON.stringify(n),`${o||"account"}.json`,"application/json")},sharePng:async(n,o)=>{if(!$){console.log("Sharing not supported");return}try{const l=await fetch(n).then(i=>i.blob());if(!l){console.error("Failed to create blob from data URL");return}const f=new File([l],`${o||"avatar"}.png`,{type:"image/png"});return C({title:o||"Gun-Vue avatar",files:[f]}).catch(i=>console.error("Share failed:",i))}catch(l){console.error("Share preparation failed:",l)}}}}const _={key:0,class:"flex p-4 items-center bg-dark-100 bg-opacity-20 mt-2 shadow-inset"},ee={key:0,class:"i-la-lock"},te={key:1,class:"i-la-unlock"},se={class:"text-sm"},ne={class:"flex flex-wrap gap-2 p-2"},le=["href"],oe={key:1,class:"flex w-full justify-center mt-4"},ie={class:"p-2 flex flex-col w-full items-start",key:"text"},ae={class:"flex gap-2 items-center mx-4"},re={key:0,class:"px-2"},ue={key:1,class:"px-2"},de={class:"w-full p-4 text-sm flex-1 rounded-xl break-all select-all",key:"text"},ve={class:"p-2 flex flex-col items-center",key:"png"},ce={class:"flex gap-2 items-center mt-4"},pe=["src"],me={class:"p-4 flex flex-col gap-2",key:"link"},ke={class:"flex flex-wrap gap-2 items-center mx-4"},xe={key:0,class:"px-2"},fe={key:1,class:"px-2"},be=["onClick"],ye={class:"px-2"},ge=["href"],we={class:"px-2 font-normal font-mono text-xs"},Ce={class:"p-4 flex flex-col gap-2 items-center",key:"qr"},Ue={__name:"AuthCredentials",emits:["close"],setup(C,{emit:$}){const{storeUser:S}=X(),u=A("pass"),{user:n}=M();function o(m){u.value!=m?u.value=m:u.value=null}const{pass:l}=K(),{text:f,copy:i,copied:c,isSupported:T}=Q(),{share:D,isSupported:L}=E(),p=A(!0),b=P(()=>{var m;return p.value?(m=l==null?void 0:l.safe)==null?void 0:m.enc:JSON.stringify(n.pair())}),k=P(()=>p.value?l.links.pass:l.links.pair),g=P(()=>Y({pub:n.pub,embed:b.value})),{savePng:R,saveJson:G,saveLink:j,sharePng:O}=Z(),V={Win:"Windows",Mac:"MacOS",Linux:"Linux"};return(m,e)=>{var N,B;return s(n).is?(r(),a("div",{class:"flex flex-col items-stretch pb-4 border-1 border-dark-100 border-opacity-10 max-w-120 mx-auto dark-bg-dark-200",key:s(n).is},[e[32]||(e[32]=t("div",{class:"mt-4 mx-6"},"Please make sure to safely store your cryptographic keypair to be able to use it again later",-1)),y(s(z)),(B=(N=s(l))==null?void 0:N.safe)!=null&&B.enc?(r(),a("div",_,[t("div",{class:"flex flex-col w-34 items-center",style:J({color:p.value?"green":"red"})},[t("button",{class:"m-2 button text-2xl",onClick:e[0]||(e[0]=d=>p.value=!p.value)},[p.value?(r(),a("div",ee)):(r(),a("div",te))]),t("div",se,w(p.value?"Encrypted":"Plain Text"),1),e[15]||(e[15]=t("div",{class:"text-m"},"Key Pair",-1))],4),t("div",ne,[t("button",{class:x(["button items-center",{active:u.value=="key"}]),onClick:e[1]||(e[1]=d=>o("key"))},e[16]||(e[16]=[t("div",{class:"i-la-envelope-open-text"},null,-1),t("div",{class:"px-2"},"Text",-1)]),2),t("button",{class:x(["button items-center",{active:u.value=="link"}]),href:k.value,target:"_blank",onClick:e[2]||(e[2]=d=>o("link"))},e[17]||(e[17]=[t("div",{class:"i-la-link"},null,-1),t("div",{class:"px-2"},"Link",-1)]),10,le),t("button",{class:x(["button items-center",{active:u.value=="qr"}]),onClick:e[3]||(e[3]=d=>o("qr"))},e[18]||(e[18]=[t("div",{class:"i-la-qrcode"},null,-1),t("div",{class:"px-2"},"QR",-1)]),2),t("button",{class:x(["button items-center",{active:u.value=="png"}]),onClick:e[4]||(e[4]=d=>o("png"))},e[19]||(e[19]=[t("div",{class:"i-la-user-circle"},null,-1),t("div",{class:"px-2"},"PNG",-1)]),2),t("button",{class:"button items-center",onClick:e[5]||(e[5]=d=>s(S)(s(n).name,s(n).pair()))},e[20]||(e[20]=[t("div",{class:"i-la-key"},null,-1),t("div",{class:"px-2"},"PassKey",-1)]))])])):v("",!0),u.value?(r(),a("div",oe,[y(U,{name:"fade",mode:"out-in"},{default:h(()=>[u.value=="key"?(r(),a("div",ie,[t("div",ae,[s(T)?(r(),a("button",{key:0,class:"button items-center",onClick:e[6]||(e[6]=d=>s(i)(b.value))},[e[21]||(e[21]=t("div",{class:"i-la-copy"},null,-1)),y(U,{name:"fade",mode:"out-in",appear:""},{default:h(()=>[s(c)?(r(),a("div",re,"Copied!")):(r(),a("div",ue,"Copy"))]),_:1})])):v("",!0),s(L)?(r(),a("button",{key:1,class:x(["button items-center",{active:u.value=="pass"}]),onClick:e[7]||(e[7]=d=>s(D)({title:s(n).name||"Gun-Vue keypair",text:b.value}))},e[22]||(e[22]=[t("div",{class:"i-la-share"},null,-1),t("div",{class:"px-1"},"Share",-1)]),2)):v("",!0),t("button",{class:"button items-center",onClick:e[8]||(e[8]=d=>s(G)(b.value,s(n).name))},e[23]||(e[23]=[t("div",{class:"i-la-download"},null,-1),t("div",{class:"px-2"},"Download",-1)]))]),t("div",de,w(b.value),1)])):u.value=="png"?(r(),a("div",ve,[t("div",ce,[t("button",{class:"button items-center",onClick:e[9]||(e[9]=d=>s(R)(g.value,s(n).name))},e[24]||(e[24]=[t("div",{class:"i-la-download"},null,-1),t("div",{class:"px-2"},"Download",-1)])),s(L)?(r(),a("button",{key:0,class:"button items-center",onClick:e[10]||(e[10]=d=>s(O)(g.value,s(n).name))},e[25]||(e[25]=[t("div",{class:"i-la-share"},null,-1),t("div",{class:"px-1"},"Share",-1)]))):v("",!0)]),t("img",{class:"cursor-pointer shadow-lg rounded-full hover-lightness-120 hover-shadow-2xl -hover-translate-y-1 transition active-translate-y-1",src:g.value,onClick:e[11]||(e[11]=d=>s(R)(g.value,s(n).name))},null,8,pe),e[26]||(e[26]=t("div",{class:"text-sm op-50 text-center m-4 max-w-50"},"Click the image to download the PNG file with your key embedded. You can use to login later. ",-1))])):u.value=="link"?(r(),a("div",me,[t("div",ke,[s(T)?(r(),a("button",{key:0,class:"button items-center",onClick:e[12]||(e[12]=d=>s(i)(k.value))},[e[27]||(e[27]=t("div",{class:"i-la-copy"},null,-1)),y(U,{name:"fade",mode:"out-in",appear:""},{default:h(()=>[s(c)?(r(),a("div",xe,"Copied!")):(r(),a("div",fe,"Copy"))]),_:1})])):v("",!0),s(L)?(r(),a("button",{key:1,class:x(["button items-center",{active:u.value=="pass"}]),onClick:e[13]||(e[13]=d=>s(D)({title:s(n).name||"Gun-Vue Login link",text:k.value}))},e[28]||(e[28]=[t("div",{class:"i-la-share"},null,-1),t("div",{class:"px-1"},"Share",-1)]),2)):v("",!0),(r(),a(W,null,I(V,(d,F)=>t("button",{class:"button items-center",key:F,onClick:$e=>s(j)(k.value,F,s(n).name)},[e[29]||(e[29]=t("div",{class:"i-la-download"},null,-1)),t("div",ye,w(d),1)],8,be)),64))]),t("a",{class:"m-2 button items-center break-all",href:k.value,target:"_blank",onClick:e[14]||(e[14]=d=>o("links"))},[e[30]||(e[30]=t("div",{class:"i-la-link"},null,-1)),t("div",we,w(k.value),1)],8,ge)])):u.value=="qr"?(r(),a("div",Ce,[y(s(H),{class:"max-w-600px",data:p.value?s(l).links.pass:s(l).links.pair},null,8,["data"]),e[31]||(e[31]=t("div",{class:"text-sm op-50 text-center mx-4 max-w-80"},"Make a screenshot to save the QR code for logging in later.",-1))])):v("",!0)]),_:1})])):v("",!0),q(m.$slots,"default")])):v("",!0)}}};export{Ue as default};
