import{h as w,aj as C,c as i,o as a,j as s,r as F,b as p,k as e,J as f,e as R,t as H,G as _,H as h,O as L}from"./framework.DMS09ad0.js";import{a_ as z,u as S,aV as T,a$ as U,i as $,aP as V,n as j,b0 as M,b1 as N,aH as A,b2 as G}from"./components.BfuT3X--.js";import{u as O}from"./useMd.B1HITcl1.js";import{f as D}from"./useRooms.C2XnVXPX.js";import{u as E}from"./useBackground.BGhjr8sS.js";import"./theme.Cz5CPBav.js";const J={class:"flex flex-col items-stretch"},q={class:"max-w-full flex flex-col items-stretche bg-light-100 bg-opacity-20 dark-bg-dark-800 dark-bg-opacity-40 p-4 md-p-12 shadow-xl backdrop-blur-md backdrop-filter rounded-t-xl"},I={class:"flex flex-wrap items-center gap-8"},K={class:"flex flex-col flex-auto",style:{flex:"100"}},Q={class:"flex gap-2 items-center"},W={key:0,class:"i-la-star"},X={key:1,class:"i-la-star-solid"},Y={class:"text-md"},Z={class:"flex items-center flex-wrap"},ee={class:"flex flex-col items-center bg-light-300 dark-bg-dark-400"},te={class:"flex flex-wrap items-center gap-2 p-4"},se={class:"relative"},oe={key:0,class:"flex items-center"},le=["innerHTML"],ae={class:"p-8"},be={__name:"RoomPage",props:{pub:{type:String,default:""},titles:{type:Object,default:()=>z}},emits:["rooms","browse","user"],setup(c){const b=c,{user:m}=S(),n=w(()=>b.pub?b.pub:$.pub),{room:o,leaveRoom:re,updateRoomProfile:x,enterRoom:ne}=T(n.value),P=O(),u=C({name:!1,description:!1,text:!1}),B=w(()=>E({pub:n.value,size:1200,attachment:"local"}));return(d,t)=>{var v,k,g,y;return a(),i("div",J,[s("div",{class:"pt-32 px-2 md-px-8 bg-cover relative flex flex-col items-center",style:L({...B.value})},[s("div",q,[s("div",I,[(a(),p(e(U),{class:"flex-1 rounded-2xl overflow-hidden min-w-20",pub:n.value,key:n.value},null,8,["pub"])),s("div",K,[s("div",Q,[f(e(V),{class:"font-bold text-2xl",text:e(o).profile.name||n.value.substring(0,12),editable:e(o).hosts[e(m).pub]&&n.value==e($).pub&&!u.name,onUpdate:t[0]||(t[0]=r=>e(x)("name",r))},null,8,["text","editable"]),t[7]||(t[7]=s("div",{class:"flex-1"},null,-1)),(v=e(m))!=null&&v.is?(a(),i("button",{key:0,class:"button z-100",onPointerdown:t[1]||(t[1]=r=>e(D)(n.value))},[e(o).isFavourite?(a(),i("div",X)):(a(),i("div",W))],32)):R("",!0)]),s("div",Y,H(e(o).profile.description),1),s("div",Z,[t[8]||(t[8]=s("div",{class:"font-bold mr-2"},"Hosts: ",-1)),(a(!0),i(_,null,h(e(o).hosts,(r,l)=>(a(),i("div",{class:"p-2 flex flex-col items-start gap-2",key:l},[f(e(j),{pub:l,selectable:!0},null,8,["pub"])]))),128))]),f(e(M),{pub:n.value,onRoom:t[2]||(t[2]=r=>d.$emit("browse","/"))},null,8,["pub"])])])])],4),F(d.$slots,"default"),s("div",ee,[s("div",te,[(a(!0),i(_,null,h(c.titles,(r,l)=>(a(),p(e(N),{key:l,cert:e(o).features[l],type:l,title:r,pub:n.value,open:e(o).features[l]||l=="users"&&e(o).features.space||l=="chat"&&e(o).features.chat,onClick:ie=>d.$emit("browse",l)},null,8,["cert","type","title","pub","open","onClick"]))),128))]),s("div",se,[u.text===!1?(a(),i("div",oe,[s("div",{class:"p-4 prose max-w-65ch",innerHTML:e(P).render(((k=e(o).profile)==null?void 0:k.text)||"")},null,8,le),(g=e(o).hosts)!=null&&g[e(m).pub]?(a(),i("button",{key:0,class:"button absolute top-4 right-4 z-200",onClick:t[3]||(t[3]=r=>{var l;return u.text=((l=e(o).profile)==null?void 0:l.text)||""})},t[9]||(t[9]=[s("div",{class:"i-la-pen"},null,-1)]))):R("",!0)])):(a(),p(e(A),{key:1,text:u.text,"onUpdate:text":t[4]||(t[4]=r=>u.text=r),onClose:t[5]||(t[5]=r=>{e(x)("text",u.text),u.text=!1})},null,8,["text"]))]),s("div",ae,[(a(),p(e(G),{state:"offline",onUser:t[6]||(t[6]=r=>d.$emit("user",r)),roomPub:(y=e(o))==null?void 0:y.pub,key:e(o).pub},null,8,["roomPub"]))])])])}}};export{be as default};
