import{d as U,h as C,p as j,v as z,c as m,o as d,aF as E,j as u,aU as I,G as V,k as o,t as x,N as f,b as A,e as F,_ as H}from"./framework.BfubPTv1.js";import{a as P,q,n as G,T as O}from"./components.DCMxoPbC.js";import{u as J}from"./useMd.BdBqpgfI.js";import{g as N}from"./useMates.CsPhqL1C.js";import"./theme.DCJEDozz.js";const K=["id","data-pub"],Q={class:"ml-2 text-sm opacity-20 hover-opacity-80 transition cursor-default text-light-200"},W={class:"ml-2 text-sm opacity-20 hover-opacity-80 transition cursor-default text-dark-200"},X={key:0,class:"text-8xl"},Y=["innerHTML"],Z=U({__name:"ChatMessage",props:{index:{type:Number,default:0},source:{type:Object,default:()=>({author:"",timestamp:"",text:"empty"})}},setup(e){const r=e,S=J(),v=C(()=>R(Number(r.source.timestamp))),{user:L}=P(),c=C(()=>r.source.author==L.pub);function R(a){if(!a)return;const t=new Date(a),s=t.toLocaleDateString("en-CA"),i=t.toLocaleTimeString("ru-RU");return{full:s+" "+i,date:s,time:i}}const p=j(!0);return z(()=>{var a,t;r.index>1&&((t=(a=document.getElementById(`chat-${r.index-1}`))==null?void 0:a.dataset)==null?void 0:t.pub)==r.source.author&&(p.value=!1)}),(a,t)=>{var s,i,h,y,b,g,k,w,n,D,T,l,M,$,B;return d(),m("div",{class:"px-1 py-2px flex flex-col w-full gap-1",style:f({alignItems:c.value?"end":"start"})},[E(u("div",{class:"flex items-center w-full mt-2",id:`chat-${e.index}`,style:f({flexDirection:c.value?"row-reverse":"row"}),"data-pub":e.source.author},[V(o(G),{class:"opacity-50 hover-opacity-90 transition",pub:e.source.author,"show-name":!0,size:20,onClick:t[0]||(t[0]=_=>o(q).pub=e.source.author)},null,8,["pub"]),u("div",Q,x((s=v.value)==null?void 0:s.time),1),t[1]||(t[1]=u("div",{class:"flex-1"},null,-1)),u("div",W,x((i=v.value)==null?void 0:i.date),1)],12,K),[[I,p.value]]),u("div",{class:"px-2 py-1 bg-light-300 dark-bg-dark-200 dark-bg-opacity-80 bg-opacity-80 rounded-b-xl max-w-max break-all overflow-hidden",style:f({borderTopLeftRadius:c.value?"12px":"0px",borderTopRightRadius:c.value?"0px":"12px",fontSize:`${(h=e.source)==null?void 0:h.text}`==o(N)(`${(y=e.source)==null?void 0:y.text}`)?"6em":"1em"})},[((b=e.source)==null?void 0:b.text)==o(N)(`${(g=e.source)==null?void 0:g.text}`)?(d(),m("div",X,x((k=e.source)==null?void 0:k.text),1)):(D=(n=(w=e.source)==null?void 0:w.text)==null?void 0:n.split)!=null&&D.call(n,"#/files/")[1]?(d(),A(o(O),{key:1,id:(M=(l=(T=e.source)==null?void 0:T.text)==null?void 0:l.split)==null?void 0:M.call(l,"#/files/")[1].slice(0,40)},null,8,["id"])):($=e.source)!=null&&$.text?(d(),m("div",{key:2,class:"markdown-body",innerHTML:o(S).render(`${(B=e.source)==null?void 0:B.text}`)},null,8,Y)):F("",!0)],4)],4)}}}),re=H(Z,[["__scopeId","data-v-2d944cf6"]]);export{re as default};
