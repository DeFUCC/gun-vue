import{d as C,p as i,c as f,e as r,k as u,o as m,j as e,b,aD as P,aE as $,a0 as l,n as A,P as B}from"./framework.BoVd_Pm6.js";import{p as x,a as j,B as D,A as E,S as N,j as S,C as K}from"./components.CAswpCM7.js";import{c as T}from"./usePassKeys.vbZW3sWo.js";import{d as U}from"./usePair.C9HcjAT2.js";import"./theme.CQ_cKKXK.js";import{_ as V}from"./AuthDerive.vue_vue_type_script_setup_true_lang.CmD9cDpL.js";const z={key:0,class:"flex flex-col items-center flex-1 p-2 bg-light-700 dark-bg-dark-200 rounded-3xl shadow-lg text-center p-4 transition duration-300ms ease-in relative"},M={class:"flex flex-wrap justify-center gap-2"},R={key:1,class:"button w-full flex justify-center items-center",type:"submit"},Q=C({__name:"AuthCreate",emits:["back"],setup(G,{emit:H}){x("deep"),x("light");const{user:k,auth:g}=j(),o=i();i("");const a=i(""),n=i(null),{history:c,undo:y}=D(n);async function d(){n.value=await N.pair()}d();function v(){g(n.value,()=>B(async()=>{await S().user(n.value.pub).get("profile").get("name").once().then()||K("name",a.value||"Noname")}))}async function w(){n.value=await U(JSON.stringify(await T(a.value)))}return(p,t)=>u(k).is?r("",!0):(m(),f("div",z,[e("button",{class:"button absolute top-4 right-4",onClick:t[0]||(t[0]=s=>p.$emit("back"))},t[9]||(t[9]=[e("div",{class:"i-la-times"},null,-1)])),t[14]||(t[14]=e("div",{class:"text-xl font-bold"},"Create a new account",-1)),t[15]||(t[15]=e("div",{class:"mb-4 mt-2"},"Tap the circle to generate a new key",-1)),n.value?(m(),b(u(E),{key:0,class:"rounded-full shadow-xl border-8",pub:n.value.pub,size:200},null,8,["pub"])):r("",!0),e("form",{class:"flex flex-col gap-4 mt-4",onSubmit:t[8]||(t[8]=l(s=>a.value&&v(),["prevent"]))},[P(e("input",{class:"p-4 rounded-2xl dark-bg-dark-200","onUpdate:modelValue":t[1]||(t[1]=s=>a.value=s),autofocus:"",placeholder:"Enter your name or nickname",autocomplete:"username"},null,512),[[$,a.value]]),e("div",M,[e("button",{class:"gap-2 button items-center",type:"button",onClick:t[2]||(t[2]=l(s=>u(c).length>2?u(y)():p.$emit("back"),["stop"]))},t[10]||(t[10]=[e("div",{class:"i-la-undo text-2xl"},null,-1)])),e("button",{class:"gap-2 button items-center",type:"button",onClick:t[3]||(t[3]=l(s=>d(),["stop"]))},t[11]||(t[11]=[e("div",{class:"i-la-dice text-2xl"},null,-1),e("div",{class:"text-sm"},"Random",-1)])),e("button",{class:"gap-2 button items-center",type:"button",onClick:t[4]||(t[4]=l(s=>w(),["stop"]))},t[12]||(t[12]=[e("div",{class:"i-la-fingerprint text-2xl"},null,-1),e("div",{class:"text-sm"},"PassKey",-1)])),e("button",{class:A(["gap-2 button items-center",{active:o.value}]),type:"button",onClick:t[5]||(t[5]=l(s=>o.value=!o.value,["stop"]))},t[13]||(t[13]=[e("div",{class:"i-la-flask text-2xl"},null,-1),e("div",{class:"text-sm"},"Derive",-1)]),2)]),o.value?(m(),b(V,{key:0,onPair:t[6]||(t[6]=s=>n.value=s),onLogin:t[7]||(t[7]=s=>v())})):r("",!0),n.value?(m(),f("button",R,"Authenticate")):r("",!0)],32)]))}});export{Q as default};
