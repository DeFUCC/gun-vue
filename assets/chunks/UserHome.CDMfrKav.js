import{d as C,p as w,q as $,aj as y,c as i,o as l,G as r,b as m,w as d,e as b,k as t,j as o,N as B,F as U,B as j,a0 as L,T as c}from"./framework.BfubPTv1.js";import{a as M,b7 as N,U as R,b8 as h,b9 as P,ba as S,bb as V,bc as A}from"./components.Cuv16BkZ.js";import"./theme.Bx92stOk.js";import F from"./RoomButton.BqsjCE6J.js";import"./useBackground.CWtXbVIk.js";const T={class:"flex flex-col items-center w-full"},q={key:1,class:"flex flex-col"},z={class:"p-4 flex flex-col items-stretch gap-4"},E={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl"},G={key:0,class:"i-la-angle-down"},H={key:1,class:"i-la-angle-up"},I={key:0,class:"flex flex-col gap-4"},O={class:"flex flex-col items-stretch bg-light-900 dark-bg-dark-500 p-2 rounded-xl"},D={key:0,class:"i-la-angle-down"},J={key:1,class:"i-la-angle-up"},ee=C({__name:"UserHome",emits:["user","room","close","chat","browse"],setup(K,{emit:Q}){var x;const{user:n}=M();function k(){n.db.get("safe").get("saved").put(!0)}const v=w(!1);$(()=>n.is,()=>{n.db.get("safe").get("saved").on(a=>v.value=a)},{immediate:!0});const u=y("showChats",!0),f=y("showRooms",!0),g=w({});return(x=n.db)==null||x.get("favorite_rooms").map().on((a,e)=>g.value[e]=a),(a,e)=>(l(),i("div",T,[r(t(R),{open:t(n).is&&!v.value,"close-button":"",onClose:e[1]||(e[1]=s=>k())},{default:d(()=>[v.value?b("",!0):(l(),m(t(N),{key:0},{default:d(()=>[o("button",{class:"button mx-8 justify-center",onClick:e[0]||(e[0]=s=>k())},e[9]||(e[9]=[o("div",{class:"i-la-check"},null,-1),o("div",{class:"ml-2"},"I've stored my key securely",-1)]))]),_:1}))]),_:1},8,["open"]),t(n).is?(l(),i("div",q,[r(t(P),{onBrowse:e[2]||(e[2]=s=>{a.$emit("browse",s),a.$emit("close")})}),o("div",z,[r(t(S)),o("button",{class:"p-2 rounded-xl font-bold text-lg shadow-md",style:B({backgroundColor:t(n).color}),onClick:e[3]||(e[3]=s=>{a.$emit("user",t(n).pub),a.$emit("close")})}," My public profile",4),e[15]||(e[15]=o("hr",{class:"w-full"},null,-1)),r(t(V),{onBrowse:e[4]||(e[4]=s=>a.$emit("room",s))}),o("div",E,[o("button",{class:"items-center w-full flex px-2 pb-2",onClick:e[5]||(e[5]=s=>f.value=!t(f))},[e[10]||(e[10]=o("div",{class:"font-bold text-lg"},"My favourite rooms",-1)),e[11]||(e[11]=o("div",{class:"flex-1"},null,-1)),t(f)?(l(),i("div",G)):(l(),i("div",H))]),r(c,{name:"fade",mode:"out-in"},{default:d(()=>[t(f)?(l(),i("div",I,[(l(!0),i(U,null,j(Object.entries(g.value).filter(([s,p])=>p).map(([s,p])=>s),s=>(l(),m(F,{key:s,pub:s,onBrowse:p=>a.$emit("room",s),panel:!1},{default:d(()=>[o("button",{class:"text-2xl",onClick:e[6]||(e[6]=L(()=>{},["stop","prevent"]))},e[12]||(e[12]=[o("div",{class:"i-la-star"},null,-1)]))]),_:2},1032,["pub","onBrowse"]))),128))])):b("",!0)]),_:1})]),o("div",O,[o("button",{class:"items-center w-full flex px-2 pb-2",onClick:e[7]||(e[7]=s=>u.value=!t(u))},[e[13]||(e[13]=o("div",{class:"font-bold text-lg"},"My chats",-1)),e[14]||(e[14]=o("div",{class:"flex-1"},null,-1)),t(u)?(l(),i("div",D)):(l(),i("div",J))]),r(c,{name:"fade",mode:"out-in"},{default:d(()=>[t(u)?(l(),m(t(A),{key:0,onChat:e[8]||(e[8]=s=>a.$emit("chat",s))})):b("",!0)]),_:1})])])])):(l(),m(t(h),{key:0}))]))}});export{ee as default};
