import{p,v as z,h as N,aR as Q,aS as V,c as u,o as n,j as l,G as w,a0 as c,n as M,t as r,k as o,w as C,F as h,B as F,e as f,T as j,b as B}from"./framework.BfubPTv1.js";import{a9 as q,U as H,H as E,aa as G}from"./components.BOfiGZ0e.js";import"./theme.BXkzN2VE.js";import{p as A}from"./index.BuUnCgYx.js";const I={class:"flex gap-2"},J={class:"text-sm"},K={class:"flex flex-col gap-2 p-4"},O=["onClick"],P={class:"text-md max-w-55ch"},W={class:"p-0"},X=["onClick"],Y={key:0,class:"flex max-w-80vw flex-wrap gap-2 p-4 items-start"},Z={class:"flex flex-col gap-2"},ee={class:"text-xl"},le={class:"font-mono text-sm"},se=["href"],te={class:"p-0"},oe={class:"p-0"},ae={class:"p-0"},ne={key:0,class:"flex gap-2 mt-2"},pe={__name:"TorrentUpload",emits:["uploaded","url"],setup(ie,{emit:U}){const{files:y,upload:D,deleteFile:T,init:L}=q(),x=p(!1),a=p(null),m=p(!1),$=U;z(L);async function S(i){var t,d;const e=((t=i.target)==null?void 0:t.files)||((d=i==null?void 0:i.dataTransfer)==null?void 0:d.files);if(!(e!=null&&e.length))return;const s=await D(e);s.length&&(a.value=s[0],$("uploaded",s[0]),$("url",v.value))}const v=N(()=>{var e,s,t;if(!((s=(e=a.value)==null?void 0:e.info)!=null&&s.infoHash))return"";let i=new URL((t=window==null?void 0:window.location)==null?void 0:t.href);return i.hash="",`${i.href}#/files/${a.value.info.infoHash}`}),b=Q({source:v}),{share:R,isSupported:_}=V(),g=p(!1),k=p(!1);return(i,e)=>(n(),u("div",I,[l("label",{class:M(["button",{"bg-light-800":m.value}]),onDragover:e[0]||(e[0]=c(s=>m.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=c(s=>m.value=!1,["prevent"])),onDrop:e[2]||(e[2]=c(s=>{S(s),m.value=!1},["prevent"]))},[e[10]||(e[10]=l("div",{class:"i-la-file-upload"},null,-1)),l("input",{type:"file",accept:"*",multiple:"",onChange:S,style:{display:"none"}},null,32)],34),l("button",{class:"button",onClick:e[3]||(e[3]=s=>x.value=!0)},[e[11]||(e[11]=l("div",{class:"i-la-share"},null,-1)),l("div",J,r(o(y).size),1)]),w(o(H),{open:x.value,onClose:e[4]||(e[4]=s=>x.value=!1)},{default:C(()=>[l("div",K,[e[14]||(e[14]=l("div",{class:"text-xl font-bold"},"Shared files",-1)),(n(!0),u(h,null,F(o(y),([s,t])=>(n(),u("div",{key:s,class:"flex gap-2 items-center p-2 bg-light-100 dark-bg-dark-400 rounded cursor-pointer",onClick:d=>a.value=t},[l("div",P,r(s),1),e[13]||(e[13]=l("div",{class:"flex-1"},null,-1)),l("div",W,r(o(A)(t.file.size)),1),l("button",{class:"p-2",onClick:c(d=>o(T)(s),["stop"])},e[12]||(e[12]=[l("div",{class:"i-la-trash"},null,-1)]),8,X)],8,O))),128))])]),_:1},8,["open"]),w(o(H),{open:!!a.value,onClose:e[9]||(e[9]=s=>a.value=null)},{default:C(()=>{var s;return[a.value?(n(),u("div",Y,[l("div",Z,[l("div",ee,r(a.value.info.name),1),l("div",le,r(a.value.info.infoHash),1),l("a",{class:"gap-2 button underline font-bold -all",href:v.value,target:"_blank"},e[15]||(e[15]=[l("div",{class:"i-la-link"},null,-1),l("div",{class:"p-0"},"Download URL",-1)]),8,se),o(b).isSupported.value?(n(),u("button",{key:0,class:"p-2 button gap-2",onClick:e[5]||(e[5]=t=>o(b).copy())},[e[16]||(e[16]=l("div",{class:"i-la-copy"},null,-1)),l("div",te,r((s=o(b))!=null&&s.copied.value?"Copied!":"Copy"),1)])):f("",!0),o(_)?(n(),u("button",{key:1,class:"p-2 button gap-2",onClick:e[6]||(e[6]=t=>{var d;return o(R)({title:(d=a.value.info)==null?void 0:d.name,url:v.value})})},e[17]||(e[17]=[l("div",{class:"i-la-share"},null,-1),l("div",{class:"p-0"}," Share",-1)]))):f("",!0),l("button",{class:"button p-2 gap-2",onClick:e[7]||(e[7]=t=>g.value=!g.value)},[e[18]||(e[18]=l("div",{class:"i-la-qrcode"},null,-1)),l("div",oe,r(g.value?"Hide":"Show")+" QR ",1)]),l("button",{class:"button p-2 gap-2",onClick:e[8]||(e[8]=t=>k.value=!k.value)},[e[19]||(e[19]=l("div",{class:"i-la-file"},null,-1)),l("div",ae,r(k.value?"Hide":"Show")+" file",1)])]),w(j,{name:"fade"},{default:C(()=>[v.value&&g.value?(n(),B(o(E),{key:0,data:v.value},null,8,["data"])):f("",!0)]),_:1}),k.value?(n(),u("div",ne,[(n(!0),u(h,null,F(a.value.torrent.files,t=>(n(),B(o(G),{class:"flex-auto max-w-70 break-all",key:t.name,file:t},null,8,["file"]))),128))])):f("",!0)])):f("",!0)]}),_:1},8,["open"])]))}};export{pe as default};
