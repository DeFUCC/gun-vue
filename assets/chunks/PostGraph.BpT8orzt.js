import{h as f,i as g}from"./components.BfL1cQFx.js";import{f as k}from"./force-graph.-gFrwpU5.js";import{aj as p,p as b,y as v,c as x,o as _,j as y,r as j}from"./framework.DOfjDz1B.js";import"./theme.2Mja-hgs.js";const w={class:"flex"},A={__name:"PostGraph",emits:["post"],setup(C,{emit:h}){const u=h,s=f(),n=p({}),l=p([]);s.user(g.pub).get("posts").map().once(async(t,e)=>{let c=e.slice(-87),m=e.slice(0,44),d=e.slice(45,89);for(let r of[m,d]){let a=await s.get("#posts").get(r).then();try{a=JSON.parse(a)}catch{}let o=a;n[r]={hash:r,name:(o==null?void 0:o.title)||(o==null?void 0:o.statement)||r}}l.push({source:m,target:d,emoji:t,author:c})});const i={};return b(()=>{const t=k()(document.getElementById("graph")).nodeId("hash").nodeColor("color").nodeRelSize(4).linkDirectionalArrowLength(6).linkDirectionalArrowRelPos(1).linkLabel("emoji").linkCurvature(e=>i[e.index]=i[e.index]||Math.random()*1-.5).linkColor(e=>"green").linkWidth(e=>2).onNodeDragEnd(e=>{e.fx=e.x,e.fy=e.y}).onNodeClick(e=>{t.centerAt(e.x,e.y,1e3),t.zoom(4,2e3)}).onNodeClick((e,c)=>{u("post",e.hash)});v(()=>t.graphData({nodes:Object.values(n),links:l}))}),(t,e)=>(_(),x("div",w,[e[0]||(e[0]=y("div",{class:"bg-light-100 bg-opacity-70 dark-bg-dark-200 backdrop-blur-md backdrop-filter overflow-hidden max-h-60vh min-h-400",id:"graph"},null,-1)),j(t.$slots,"default")]))}};export{A as default};
