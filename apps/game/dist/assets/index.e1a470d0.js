var N=Object.defineProperty;var j=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var P=(r,t,n)=>t in r?N(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,k=(r,t)=>{for(var n in t||(t={}))V.call(t,n)&&P(r,n,t[n]);if(j)for(var n of j(t))B.call(t,n)&&P(r,n,t[n]);return r};import{_ as G,d as _,s as U}from"./index.4e9fd113.js";import{z as F,C as O,o as f,c as b,D as w,E,H as W,i as C,u as h,d as $,I as q,w as J,a as Z,F as K,b as Q,g as X,J as Y}from"./vendor.74426c0a.js";(()=>{if(!n())return;const r=CanvasRenderingContext2D.prototype,t=r.drawImage;if(!t){console.error("This script requires a basic implementation of drawImage");return}r.drawImage=function(e,a,i){if(!(arguments.length===9))return t.apply(this,[...arguments]);const p=s(...arguments);if(!l(p))return t.apply(this,p)};function n(){const u=document.createElement("canvas").getContext("2d");u.fillRect(0,0,40,40),u.drawImage(u.canvas,-40,-40,80,80,50,50,20,20);const e=u.getImageData(50,50,30,30),a=new Uint32Array(e.data.buffer),i=(d,m)=>a[m*e.width+d],c=[[9,9],[20,9],[9,20],[20,20]],p=[[10,10],[19,10],[10,19],[19,19]];return c.some(([d,m])=>i(d,m)!==0)||p.some(([d,m])=>i(d,m)===0)}function s(u,e,a,i,c,p,d,m,g){const{width:T,height:H}=o(u);i<0&&(e+=i,i=Math.abs(i)),c<0&&(a+=c,c=Math.abs(c)),m<0&&(p+=m,m=Math.abs(m)),g<0&&(d+=g,g=Math.abs(g));const x=Math.max(e,0),D=Math.min(e+i,T),v=Math.max(a,0),M=Math.min(a+c,H),A=m/i,S=g/c;return[u,x,v,D-x,M-v,e<0?p-e*A:p,a<0?d-a*S:d,(D-x)*A,(M-v)*S]}function l(u){return[3,4,7,8].some(e=>!u[e])}function o(u){const e=a=>{const i=globalThis[a];return i&&u instanceof i};if(e("HTMLImageElement"))return{width:u.naturalWidth,height:u.naturalHeight};if(e("HTMLVideoElement"))return{width:u.videoWidth,height:u.videoHeight};if(e("SVGImageElement"))throw new TypeError("SVGImageElement isn't yet supported as source image.","UnsupportedError");if(e("HTMLCanvasElement")||e("ImageBitmap"))return u}})();const y={};if(document){class r extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"}),this.img=document.createElement("img"),this.shadowRoot.append(this.img)}render(){this.pub=this.hasAttribute("pub")?this.getAttribute("pub"):"1234123455Ute2tFhdjDQgzR-1234lfSlZxgEZKuquI.2F-j1234434U1234Asj-5lxnECG5TDyuPD8gEiuI123",this.size=this.hasAttribute("size")?this.getAttribute("size"):400,this.round=!!(this.hasAttribute("round")||this.getAttribute("round")==""),this.round?this.img.style.borderRadius="100%":this.img.style.borderRadius="0%",this.dark=!!(this.hasAttribute("dark")||this.getAttribute("dark")==""),this.img.src=I(this.pub,this.size,this.dark)}connectedCallback(){this.render()}static get observedAttributes(){return["pub","round","size","dark"]}attributeChangedCallback(n,s,l){this.render()}}customElements.define("gun-avatar",r),document.addEventListener("DOMContentLoaded",()=>{let t=document.getElementsByClassName("gun-avatar");for(let n of t)n.src=I(n.dataset.pub,n.dataset.size,n.dataset.dark)})}function I(r,t=800,n=!1){var s;if(!r)return;if((s=y==null?void 0:y[t])==null?void 0:s[r])return y[t][r];const l=document.createElement("canvas");l.width=l.height=t;const o=l.getContext("2d"),e=r.split(".").map(a=>tt(a));return z(o,e[0][42],e[1][42],t,n),R(e[0],o,t,.42*t),o.globalCompositeOperation="lighter",R(e[1],o,t,.125*t),o.globalCompositeOperation="source-over",o.scale(-1,1),o.translate(-t/2,0),o.drawImage(l,t/2,0,t,t,0,0,t,t),y[t]=y[t]||{},y[t][r]=l.toDataURL(),y[t][r]}function z(r,t,n,s,l=!1){var o=r.createLinearGradient(0,0,0,s);let u=70;l&&(u=0),o.addColorStop(0,`hsl(0,0%,${u+t*30}%)`),o.addColorStop(1,`hsl(0,0%,${u+n*30}%)`),r.fillStyle=o,r.fillRect(0,0,s,s)}function R(r,t,n,s){et(r,7).forEach(o=>{if(o.length==7){let u=n/2+o[0]*n/2,e=o[1]*n,a=o[2]*s,i=o[3]*360,c=o[4]*100,p=o[5]*100,d=o[6];t.beginPath(),t.arc(u,e,a,0,2*Math.PI,!1),t.fillStyle=`hsla(${i},${c}%,${p}%,${d})`,t.closePath(),t.fill()}})}function tt(r){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split("");let s=[],l=0;for(let o of r)s[l++]=n.indexOf(o)/64;return s}function et(r,t=3){return[...Array(Math.ceil(r.length/t))].map(()=>r.splice(0,t))}const nt=["title"],rt={props:{pub:String,size:{type:Number,default:40}},setup(r){const t=r,n=F("");return O(()=>{t.pub&&t.pub.includes(".")&&t.size>=10&&(n.value=I(t.pub,32))}),(s,l)=>r.pub?(f(),b("div",{key:0,class:"avatar bg-local",title:r.pub,style:w({background:`url(${n.value})`})},null,12,nt)):E("",!0)}};var st=G(rt,[["__scopeId","data-v-6ac7670a"]]),L={exports:{}};(function(r,t){(function(n,s){r.exports=s()})(W,function(){const n=(e,a,i,c)=>{const p=(a*i+2*e)/i**3,d=-(2*a*i+3*e)/i**2,m=a,g=e;return p*c**3+d*c**2+m*c+g},s=(e,a,i,c)=>{const p=(a*i+2*e)/i**3,d=-(2*a*i+3*e)/i**2,m=a;return 3*p*c**2+2*d*c+m},l=function(e,a){Object.entries(typeof e=="number"?{value:e}:e).map(([c,p])=>a(p,c))};function o(e,a){this.start=new Date/1e3,this.time=a,this.from=e,this.current=e,this.to=e,this.speed=0}o.prototype.get=function(e){const a=e/1e3-this.start;if(a<0)throw new Error("Cannot read in the past");return a>=this.time?this.to:this.to-n(this.to-this.from,this.speed,this.time,a)},o.prototype.getSpeed=function(e){const a=e/1e3-this.start;return a>=this.time?0:s(this.to-this.from,this.speed,this.time,a)},o.prototype.set=function(e,a){const i=new Date,c=this.get(i);return this.speed=this.getSpeed(i),this.start=i/1e3,this.from=c,this.to=e,a&&(this.time=a),c};function u(e,a=300){return typeof e=="number"&&(e={value:e}),l(e,(i,c)=>{const p=new o(i,a/1e3);Object.defineProperty(e,"_"+c,{value:p}),Object.defineProperty(e,"$"+c,{get:()=>p.to}),Object.defineProperty(e,c,{get:()=>p.get(new Date),set:d=>p.set(d),enumerable:!0})}),Object.defineProperty(e,"get",{get:()=>function(i="value",c=new Date){return this["_"+i].get(c)}}),Object.defineProperty(e,"set",{get:()=>function(i,c=0){l(i,(p,d)=>{this["_"+d].set(p,c/1e3)})}}),e}return u})})(L);var at=L.exports;const ot={props:{pub:String,pulse:Number,x:Number,y:Number},emits:["remove"],setup(r,{emit:t}){const n=r,s=at({x:n.x,y:n.y,pulse:n.pulse},1e3),l=C({x:s.x,y:s.y,size:Date.now()-s.pulse});return O(()=>{s.set({x:n.x,y:n.y})}),setInterval(()=>{(s.x!=n.x||s.y!=n.y)&&(l.x=s.x,l.y=s.y),s.pulse=n.pulse,l.size=(150/(Date.now()/1e4-s.pulse/1e4)).toFixed(),l.size<30&&t("remove")},10),(o,u)=>{const e=st;return f(),b("div",{class:"m-1 flex absolute pointer-events-none opacity-80",style:w({transform:"translate(-50%,-50%)",left:h(l).x*100+"%",top:h(l).y*100+"%"})},[h(l).size>100?(f(),b("div",{key:0,class:"w-40px transition-all duration-100 ease",style:w({transform:`scale(${h(l).size/500})`})},[$(e,{class:"rounded-full",pub:r.pub,size:100},null,8,["pub"])],4)):E("",!0)],4)}}};function it(){const r=C({count:0,max:10,list:{}});_.get("playersCount").on(s=>r.count=s),_.get("players").map().on((s,l)=>{s!=null&&(r.list[l]=k({},s))});const t=C({pair:null,num:null,pub:null,x:0,y:0});async function n(){t.pair=await U.pair(),t.pub=t.pair.pub,t.num=r.count%r.max;const s=_.get("players").get(t.num);document.addEventListener("mousemove",o=>{t.x=o.clientX/document.documentElement.clientWidth,t.y=o.clientY/document.documentElement.clientHeight,s.put({x:t.x,y:t.y})}),setInterval(()=>{s.get("pulse").put(Date.now())},500);let l={pub:t.pub,pulse:Date.now(),x:Math.random(),y:Math.random()};s.put(l),_.get("playersCount").put(t.num+1)}return{players:r,me:t,join:n}}const lt={class:"flex flex-col p-4"},ct=Z("div",{class:"font-bold"},"Players online",-1),mt={setup(r){const{players:t,me:n,join:s}=it();return(l,o)=>{const u=ot;return f(),b("div",lt,[ct,h(n).pub?E("",!0):(f(),b("button",{key:0,class:"hover:shadow-xl m-2 p-4 shadow-md transition-all duration-400 ease",onClick:o[0]||(o[0]=e=>h(s)())},"Join")),(f(),b("div",{class:"flex flex-col",key:h(t).count},[$(q,{name:"fade"},{default:J(()=>[(f(!0),b(K,null,Q(h(t).list,(e,a)=>(f(),X(u,Y({key:e.pub},e),null,16))),128))]),_:1})]))])}}};export{mt as default};
