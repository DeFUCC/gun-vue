import{i as f,m,q as v,o as u,c as p,a as r,t as b,u as a,s as c,v as d}from"./vendor.74426c0a.js";import{g as o,s as g}from"./index.4e9fd113.js";const s=f({is:null,pub:m(()=>{var t;return(t=s.is)==null?void 0:t.pub}),profile:{},pair:null,name:null,presence:null,graph(){return o.user()},async generate(){s.pair=await g.pair()},init(){s.is=o.user().is,s.presence=setInterval(()=>{o.user().get("presence").put(Date.now())},1500),o.user().get("profile").map().on((t,e)=>{s.profile[e]=t})},logout(){var e;let t=!!((e=s.is)==null?void 0:e.pub);o.user().leave(),clearInterval(s.presence),setTimeout(()=>{var l;t&&!((l=o.user()._)==null?void 0:l.sea)&&(s.is=null,s.profile={},console.info("User logged out"))},500)},auth(t=s.pair){if(!t)return console.log("No pair to auth");o.user().auth(t,async()=>{})},async hasPass(t){return await o.get(`~${t}`).get("pass").get("pair").then()},async logWithPass(t,e){let l=await o.get(`~${t}`).get("pass").get("pair").then(),n=await g.decrypt(l,e);participate(n)}});function x(){return v(s.profile,t=>{for(let e in t)o.user().get("profile").get(e).put(t[e])}),{account:s}}o.user().recall({sessionStorage:!0},()=>{s.init()});o.on("auth",()=>{s.init()});const h={class:"flex flex-col p-8"},y={class:"text-sm"},_={class:"p-2 rounded-xl border-1"},k=r("label",{for:"name"},"Name",-1),w={class:"p-2 rounded-xl border-1"},$=r("label",{for:"name"},"Age",-1),C={setup(t){const{account:e}=x();return(l,n)=>(u(),p("div",h,[r("div",y,b(a(e)),1),r("button",{class:"button",onClick:n[0]||(n[0]=i=>a(e).generate())},"Generate"),r("div",_,[k,c(r("input",{id:"name",type:"text","onUpdate:modelValue":n[1]||(n[1]=i=>a(e).name=i)},null,512),[[d,a(e).name]])]),a(e).is?(u(),p("button",{key:1,class:"button",onClick:n[3]||(n[3]=i=>a(e).logout())},"Logout")):(u(),p("button",{key:0,class:"button",onClick:n[2]||(n[2]=i=>a(e).auth())},"Auth")),r("div",w,[$,c(r("input",{id:"name",type:"text","onUpdate:modelValue":n[4]||(n[4]=i=>a(e).profile.age=i)},null,512),[[d,a(e).profile.age]])])]))}};export{C as default};
